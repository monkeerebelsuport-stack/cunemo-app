[{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\api\\email\\send\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\api\\integrations\\google-calendar\\auth\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\api\\integrations\\google-calendar\\callback\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\activities\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\billing\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\companies\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCompanies'. Either include it or remove the dependency array.","line":15,"column":8,"nodeType":"ArrayExpression","endLine":15,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCompanies]","fix":{"range":[581,583],"text":"[fetchCompanies]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Building, Plus, Search, Filter, Globe, Calendar, MoreHorizontal, Loader2 } from \"lucide-react\";\r\nimport { useCompanies } from \"@/hooks/useCompanies\";\r\nimport { useEffect, useState } from \"react\";\r\nimport NewCompanyModal from \"@/components/companies/NewCompanyModal\";\r\n\r\nexport default function CompaniesPage() {\r\n    const { companies, fetchCompanies, loading } = useCompanies();\r\n    const [searchTerm, setSearchTerm] = useState(\"\");\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchCompanies();\r\n    }, []);\r\n\r\n    const filteredCompanies = companies.filter(c =>\r\n        c.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        c.industry?.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-fadeIn h-full flex flex-col\">\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-gray-800\" style={{ fontFamily: 'Montserrat, sans-serif' }}>\r\n                        Empresas üè¢\r\n                    </h1>\r\n                    <p className=\"text-gray-500 mt-2\">Gestiona las organizaciones y cuentas clave de tu pipeline.</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setIsModalOpen(true)}\r\n                    className=\"btn-primary shadow-lg hover:shadow-xl transition-all\"\r\n                >\r\n                    <Plus size={18} /> Nueva Empresa\r\n                </button>\r\n            </div>\r\n\r\n            {/* B√∫squeda y Filtros */}\r\n            <div className=\"bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex gap-4 items-center\">\r\n                <div className=\"relative flex-1\">\r\n                    <Search size={18} className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                        placeholder=\"Buscar por nombre o industria...\"\r\n                        className=\"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent outline-none transition-all text-sm\"\r\n                    />\r\n                </div>\r\n                <button className=\"flex items-center gap-2 px-4 py-2 text-gray-600 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium\">\r\n                    <Filter size={18} />\r\n                    Filtros\r\n                </button>\r\n            </div>\r\n\r\n            {/* Listado de Empresas */}\r\n            <div className=\"flex-1 bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden flex flex-col\">\r\n                <div className=\"grid grid-cols-12 gap-4 p-4 border-b border-gray-100 bg-gray-50/50 text-[10px] font-bold text-gray-400 uppercase tracking-widest\">\r\n                    <div className=\"col-span-1 flex items-center justify-center\">#</div>\r\n                    <div className=\"col-span-4\">Nombre de Empresa</div>\r\n                    <div className=\"col-span-3\">Industria / Web</div>\r\n                    <div className=\"col-span-3\">Fecha Registro</div>\r\n                    <div className=\"col-span-1 text-right pr-4\">Acciones</div>\r\n                </div>\r\n\r\n                <div className=\"flex-1 overflow-y-auto\">\r\n                    {loading ? (\r\n                        <div className=\"flex h-full items-center justify-center p-12\">\r\n                            <Loader2 className=\"w-8 h-8 text-[#00AEEF] animate-spin\" />\r\n                        </div>\r\n                    ) : filteredCompanies.length > 0 ? (\r\n                        filteredCompanies.map((company, index) => (\r\n                            <div key={company.id} className=\"grid grid-cols-12 gap-4 p-4 border-b border-gray-50 hover:bg-gray-50/50 transition-colors items-center group\">\r\n                                <div className=\"col-span-1 flex items-center justify-center\">\r\n                                    <div className=\"w-8 h-8 bg-gray-50 rounded-lg flex items-center justify-center text-xs font-bold text-gray-400 group-hover:bg-blue-50 group-hover:text-[#00AEEF] transition-colors\">\r\n                                        {index + 1}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"col-span-4\">\r\n                                    <p className=\"font-bold text-gray-800 text-sm\">{company.name}</p>\r\n                                </div>\r\n                                <div className=\"col-span-3 space-y-1\">\r\n                                    {company.industry && (\r\n                                        <span className=\"inline-block px-2 py-0.5 bg-gray-100 text-gray-500 rounded text-[10px] font-medium\">\r\n                                            {company.industry}\r\n                                        </span>\r\n                                    )}\r\n                                    {company.website && (\r\n                                        <div className=\"flex items-center gap-1.5 text-[10px] text-blue-500 hover:underline\">\r\n                                            <Globe size={10} />\r\n                                            <a href={company.website} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                                                Sitio Web\r\n                                            </a>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                                <div className=\"col-span-3 flex items-center gap-2 text-xs text-gray-400\">\r\n                                    <Calendar size={14} />\r\n                                    {new Date(company.created_at).toLocaleDateString()}\r\n                                </div>\r\n                                <div className=\"col-span-1 text-right pr-4\">\r\n                                    <button className=\"p-1.5 hover:bg-gray-100 rounded-lg transition-colors text-gray-400 hover:text-gray-600\">\r\n                                        <MoreHorizontal size={18} />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center h-full p-12 text-center\">\r\n                            <div className=\"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mb-4 text-gray-200\">\r\n                                <Building size={32} />\r\n                            </div>\r\n                            <h3 className=\"text-lg font-bold text-gray-800 mb-1\">No hay empresas a√∫n</h3>\r\n                            <p className=\"text-sm text-gray-400 max-w-xs px-4\">\r\n                                Comienza a construir tu base de datos corporativa a√±adiendo tu primera organizaci√≥n.\r\n                            </p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <NewCompanyModal\r\n                isOpen={isModalOpen}\r\n                onClose={() => setIsModalOpen(false)}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\contacts\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchContacts'. Either include it or remove the dependency array.","line":16,"column":8,"nodeType":"ArrayExpression","endLine":16,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchContacts]","fix":{"range":[600,602],"text":"[fetchContacts]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nexport const dynamic = 'force-dynamic';\r\n\r\nimport { Search, Plus, Filter, MoreHorizontal, Mail, Phone, Loader2 } from \"lucide-react\";\r\nimport { useContacts } from \"@/hooks/useContacts\";\r\nimport { useEffect, useState } from \"react\";\r\nimport NewContactModal from \"@/components/contacts/NewContactModal\";\r\n\r\nexport default function ContactsPage() {\r\n    const { contacts, fetchContacts, loading } = useContacts();\r\n    const [searchTerm, setSearchTerm] = useState(\"\");\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchContacts();\r\n    }, []);\r\n\r\n    const filteredContacts = contacts.filter(c =>\r\n        `${c.first_name} ${c.last_name}`.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        c.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        c.account_name?.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <div className=\"h-full flex flex-col space-y-6\">\r\n            {/* Header & Actions */}\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-gray-800\" style={{ fontFamily: 'Montserrat, sans-serif' }}>\r\n                        Contactos\r\n                    </h1>\r\n                    <p className=\"text-gray-500 text-sm\">Gestiona tu base de datos de clientes y prospectos</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setIsModalOpen(true)}\r\n                    className=\"btn-primary shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all\"\r\n                >\r\n                    <Plus size={20} />\r\n                    <span>Nuevo Contacto</span>\r\n                </button>\r\n            </div>\r\n\r\n            {/* Filters & Search Bar */}\r\n            <div className=\"bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex gap-4 items-center\">\r\n                <div className=\"relative flex-1\">\r\n                    <Search size={18} className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                        placeholder=\"Buscar por nombre, empresa o correo...\"\r\n                        className=\"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent outline-none transition-all placeholder-gray-400 text-sm\"\r\n                    />\r\n                </div>\r\n                <button className=\"flex items-center gap-2 px-4 py-2 text-gray-600 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium\">\r\n                    <Filter size={18} />\r\n                    Filtros\r\n                </button>\r\n            </div>\r\n\r\n            {/* Contacts Table */}\r\n            <div className=\"flex-1 bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden flex flex-col\">\r\n                {/* Table Header */}\r\n                <div className=\"grid grid-cols-12 gap-4 p-4 border-b border-gray-100 bg-gray-50/50 text-xs font-semibold text-gray-500 uppercase tracking-wider\">\r\n                    <div className=\"col-span-4 pl-4\">Nombre / Empresa</div>\r\n                    <div className=\"col-span-3\">Contacto</div>\r\n                    <div className=\"col-span-2\">Cargo</div>\r\n                    <div className=\"col-span-2\">Creado el</div>\r\n                    <div className=\"col-span-1 text-right pr-4\">Acciones</div>\r\n                </div>\r\n\r\n                <div className=\"flex-1 overflow-y-auto\">\r\n                    {loading ? (\r\n                        <div className=\"flex h-full items-center justify-center p-12\">\r\n                            <Loader2 className=\"w-8 h-8 text-[#00AEEF] animate-spin\" />\r\n                        </div>\r\n                    ) : filteredContacts.length > 0 ? (\r\n                        filteredContacts.map((contact) => (\r\n                            <div key={contact.id} className=\"grid grid-cols-12 gap-4 p-4 border-b border-gray-50 hover:bg-gray-50/50 transition-colors items-center\">\r\n                                <div className=\"col-span-4 pl-4\">\r\n                                    <p className=\"font-bold text-gray-800 text-sm\">{contact.first_name} {contact.last_name}</p>\r\n                                    <p className=\"text-xs text-gray-400\">{contact.account_name}</p>\r\n                                </div>\r\n                                <div className=\"col-span-3 flex flex-col gap-1\">\r\n                                    {contact.email && <div className=\"flex items-center gap-1.5 text-xs text-gray-500 truncate\"><Mail size={12} /> {contact.email}</div>}\r\n                                    {contact.phone && <div className=\"flex items-center gap-1.5 text-xs text-gray-500\"><Phone size={12} /> {contact.phone}</div>}\r\n                                </div>\r\n                                <div className=\"col-span-2 text-sm text-gray-600\">\r\n                                    {contact.job_title || \"-\"}\r\n                                </div>\r\n                                <div className=\"col-span-2 text-xs text-gray-400\">\r\n                                    {new Date(contact.created_at).toLocaleDateString()}\r\n                                </div>\r\n                                <div className=\"col-span-1 text-right pr-4\">\r\n                                    <button className=\"p-1 hover:bg-gray-100 rounded-md transition-colors text-gray-400 hover:text-gray-600\">\r\n                                        <MoreHorizontal size={18} />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center text-center p-12 h-full\">\r\n                            <div className=\"w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mb-4\">\r\n                                <div className=\"text-4xl\">üë•</div>\r\n                            </div>\r\n                            <h3 className=\"text-lg font-bold text-gray-800 mb-2\">No se encontraron contactos</h3>\r\n                            <p className=\"text-gray-500 max-w-sm mb-6\">\r\n                                {searchTerm ? \"Ajusta tu b√∫squeda para encontrar lo que necesitas.\" : \"Tu base de datos est√° vac√≠a. Agrega tu primer contacto.\"}\r\n                            </p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n            <NewContactModal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\deals\\[id]\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchDeal'. Either include it or remove the dependency array.","line":31,"column":8,"nodeType":"ArrayExpression","endLine":31,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [dealId, fetchDeal]","fix":{"range":[1258,1266],"text":"[dealId, fetchDeal]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDeal } from \"@/hooks/useDeal\";\r\nimport ActivityModal from \"@/components/deals/ActivityModal\";\r\nimport EditDealModal from \"@/components/deals/EditDealModal\";\r\nimport { ActivityType } from \"@/types/pipeline\";\r\nimport { ArrowLeft, Edit2, Phone, Mail, FileText, Calendar, DollarSign, Building } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useParams } from \"next/navigation\";\r\n\r\nexport default function DealDetailPage() {\r\n    const params = useParams();\r\n    const { deal, activities, loading, error, fetchDeal } = useDeal();\r\n    const [isActivityModalOpen, setIsActivityModalOpen] = useState(false);\r\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n    const [activityType, setActivityType] = useState<ActivityType>(\"call\");\r\n\r\n    // Inline Editing States\r\n    const [isEditingValue, setIsEditingValue] = useState(false);\r\n    const [isEditingProbability, setIsEditingProbability] = useState(false);\r\n    const [tempValue, setTempValue] = useState(\"\");\r\n    const [tempProb, setTempProb] = useState(\"\");\r\n\r\n    const dealId = params.id as string;\r\n\r\n    useEffect(() => {\r\n        if (dealId) {\r\n            fetchDeal(dealId);\r\n        }\r\n    }, [dealId]);\r\n\r\n    const openActivityModal = (type: ActivityType) => {\r\n        setActivityType(type);\r\n        setIsActivityModalOpen(true);\r\n    };\r\n\r\n    const { updateDeal } = useDeal();\r\n\r\n    const handleSaveValue = async () => {\r\n        if (!deal) return;\r\n        const numValue = parseFloat(tempValue);\r\n        if (!isNaN(numValue) && numValue !== deal.value) {\r\n            await updateDeal(deal.id, { value: numValue });\r\n        }\r\n        setIsEditingValue(false);\r\n    };\r\n\r\n    const handleSaveProb = async () => {\r\n        if (!deal) return;\r\n        const numProb = parseInt(tempProb);\r\n        if (!isNaN(numProb) && numProb >= 0 && numProb <= 100 && numProb !== deal.probability) {\r\n            await updateDeal(deal.id, { probability: numProb });\r\n        }\r\n        setIsEditingProbability(false);\r\n    };\r\n\r\n    if (loading) return (\r\n        <div className=\"h-full flex items-center justify-center\">\r\n            <div className=\"w-8 h-8 border-4 border-[#00AEEF] border-t-transparent rounded-full animate-spin\"></div>\r\n        </div>\r\n    );\r\n\r\n    if (error || !deal) return (\r\n        <div className=\"p-8 text-center text-gray-500\">\r\n            <p>No se encontr√≥ el negocio o hubo un error.</p>\r\n            <Link href=\"/dashboard/deals\" className=\"text-blue-500 hover:underline mt-2 inline-block\">Volver al tablero</Link>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"max-w-5xl mx-auto space-y-6 pb-12 animate-fadeIn\">\r\n            <ActivityModal\r\n                isOpen={isActivityModalOpen}\r\n                onClose={() => setIsActivityModalOpen(false)}\r\n                dealId={deal.id}\r\n                initialType={activityType}\r\n            />\r\n\r\n            {deal && (\r\n                <EditDealModal\r\n                    isOpen={isEditModalOpen}\r\n                    onClose={() => setIsEditModalOpen(false)}\r\n                    deal={deal}\r\n                />\r\n            )}\r\n\r\n            {/* Header / Breadcrumb */}\r\n            <div className=\"flex items-center gap-2 text-sm text-gray-400 mb-2\">\r\n                <Link href=\"/dashboard/deals\" className=\"hover:text-gray-600 flex items-center gap-1\">\r\n                    <ArrowLeft size={14} /> Negocios\r\n                </Link>\r\n                <span>/</span>\r\n                <span className=\"text-gray-600 font-medium truncate max-w-[200px]\">{deal.title}</span>\r\n            </div>\r\n\r\n            {/* Main Header Card */}\r\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 p-8 relative overflow-hidden\">\r\n                <div className=\"relative z-10 flex justify-between items-start\">\r\n                    <div>\r\n                        <div className=\"flex items-center gap-3 mb-2\">\r\n                            <span className=\"bg-blue-50 text-blue-600 text-xs font-bold px-2 py-1 rounded-md uppercase tracking-wide\">\r\n                                {deal.stageId}\r\n                            </span>\r\n                            <span className=\"text-gray-400 text-sm flex items-center gap-1\">\r\n                                <Building size={14} /> {deal.companyName}\r\n                            </span>\r\n                        </div>\r\n                        <h1 className=\"text-3xl font-bold text-gray-800 mb-4\" style={{ fontFamily: 'Montserrat, sans-serif' }}>\r\n                            {deal.title}\r\n                        </h1>\r\n                        <div className=\"flex gap-4\">\r\n                            <button\r\n                                onClick={() => openActivityModal(\"call\")}\r\n                                className=\"flex items-center gap-2 px-4 py-2 bg-[#00AEEF] text-white rounded-lg font-medium shadow-md shadow-blue-200 hover:bg-[#009bd6] transition-colors\"\r\n                            >\r\n                                <Phone size={18} /> Llamar\r\n                            </button>\r\n                            <button\r\n                                onClick={() => openActivityModal(\"email\")}\r\n                                className=\"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 text-gray-600 rounded-lg font-medium hover:bg-gray-50 transition-colors\"\r\n                            >\r\n                                <Mail size={18} /> Email\r\n                            </button>\r\n                            <div className=\"h-10 w-px bg-gray-100 mx-2\" />\r\n                            {deal.stageId !== 'WON' && deal.stageId !== 'LOST' && (\r\n                                <>\r\n                                    <button\r\n                                        onClick={async () => {\r\n                                            await updateDeal(deal.id, { stage: 'WON', probability: 100 });\r\n                                        }}\r\n                                        className=\"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg font-medium shadow-md shadow-green-100 hover:bg-green-600 transition-colors\"\r\n                                    >\r\n                                        Gan√© este negocio üèÜ\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={async () => {\r\n                                            await updateDeal(deal.id, { stage: 'LOST', probability: 0 });\r\n                                        }}\r\n                                        className=\"flex items-center gap-2 px-4 py-2 border border-red-200 text-red-600 rounded-lg font-medium hover:bg-red-50 transition-colors\"\r\n                                    >\r\n                                        Lo perd√≠ ‚ùå\r\n                                    </button>\r\n                                </>\r\n                            )}\r\n                            {deal.stageId === 'WON' && (\r\n                                <div className=\"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-lg font-bold border border-green-200\">\r\n                                    ¬°Oportunidad Ganada! üèÜ\r\n                                </div>\r\n                            )}\r\n                            {deal.stageId === 'LOST' && (\r\n                                <div className=\"flex items-center gap-2 px-4 py-2 bg-red-50 text-red-700 rounded-lg font-bold border border-red-200\">\r\n                                    Oportunidad Perdida ‚ùå\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                        <div className=\"flex items-center justify-end gap-2 text-gray-400 mb-1 text-sm font-medium\">\r\n                            <DollarSign size={16} /> Valor Estimado\r\n                        </div>\r\n\r\n                        {isEditingValue ? (\r\n                            <input\r\n                                type=\"number\"\r\n                                value={tempValue}\r\n                                onChange={(e) => setTempValue(e.target.value)}\r\n                                onBlur={handleSaveValue}\r\n                                onKeyDown={(e) => e.key === 'Enter' && handleSaveValue()}\r\n                                className=\"text-4xl font-bold text-gray-800 tracking-tight text-right w-full bg-blue-50/50 border-b-2 border-blue-500 outline-none px-2 rounded-t-lg\"\r\n                                autoFocus\r\n                            />\r\n                        ) : (\r\n                            <div\r\n                                onClick={() => {\r\n                                    setTempValue(deal.value.toString());\r\n                                    setIsEditingValue(true);\r\n                                }}\r\n                                className=\"text-4xl font-bold text-gray-800 tracking-tight cursor-pointer hover:bg-gray-50 px-2 rounded-lg transition-colors border-b-2 border-transparent hover:border-gray-200\"\r\n                            >\r\n                                {deal.currency}{deal.value.toLocaleString()}\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"text-sm text-gray-400 mt-2 flex items-center justify-end gap-1\">\r\n                            Probabilidad:\r\n                            {isEditingProbability ? (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        min=\"0\"\r\n                                        max=\"100\"\r\n                                        value={tempProb}\r\n                                        onChange={(e) => setTempProb(e.target.value)}\r\n                                        onBlur={handleSaveProb}\r\n                                        onKeyDown={(e) => e.key === 'Enter' && handleSaveProb()}\r\n                                        className=\"w-16 font-bold text-green-500 bg-green-50/50 border-b-2 border-green-500 outline-none text-right px-1\"\r\n                                        autoFocus\r\n                                    />\r\n                                    <span className=\"font-bold text-green-500\">%</span>\r\n                                </div>\r\n                            ) : (\r\n                                <span\r\n                                    onClick={() => {\r\n                                        setTempProb(deal.probability.toString());\r\n                                        setIsEditingProbability(true);\r\n                                    }}\r\n                                    className=\"font-bold text-green-500 cursor-pointer hover:bg-green-50 px-1 rounded transition-colors border-b border-transparent hover:border-green-200\"\r\n                                >\r\n                                    {deal.probability}%\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                {/* Decorative Background */}\r\n                <div className=\"absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-gray-50 to-blue-50/50 rounded-bl-full -z-0 opacity-50\" />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-3 gap-6\">\r\n                {/* Left Column: Timeline */}\r\n                <div className=\"col-span-2 space-y-6\">\r\n                    <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 min-h-[400px]\">\r\n                        <div className=\"flex items-center justify-between mb-4\">\r\n                            <h3 className=\"font-bold text-gray-800 text-lg\">L√≠nea de Tiempo</h3>\r\n                            <button\r\n                                onClick={() => openActivityModal(\"note\")}\r\n                                className=\"text-sm text-[#00AEEF] font-medium hover:underline\"\r\n                            >\r\n                                + Nueva Actividad\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"relative border-l-2 border-gray-100 ml-3 space-y-8 pl-8 py-2\">\r\n                            {/* Render Activities */}\r\n                            {activities && activities.length > 0 ? (\r\n                                activities.map((activity) => (\r\n                                    <div key={activity.id} className=\"relative\">\r\n                                        <div className=\"absolute -left-[39px] w-6 h-6 bg-blue-100 rounded-full border-2 border-white flex items-center justify-center text-blue-600\">\r\n                                            {activity.type === 'call' && <Phone size={12} />}\r\n                                            {activity.type === 'email' && <Mail size={12} />}\r\n                                            {activity.type === 'meeting' && <Calendar size={12} />}\r\n                                            {activity.type === 'note' && <FileText size={12} />}\r\n                                        </div>\r\n                                        <p className=\"text-xs text-gray-400 mb-1\">\r\n                                            {new Date(activity.created_at).toLocaleString()}\r\n                                        </p>\r\n                                        <p className=\"text-gray-800 font-medium\">{activity.subject}</p>\r\n                                        {activity.notes && (\r\n                                            <p className=\"text-sm text-gray-500 mt-1 bg-gray-50 p-2 rounded-md\">{activity.notes}</p>\r\n                                        )}\r\n                                    </div>\r\n                                ))\r\n                            ) : null}\r\n\r\n                            {/* Initial Event: Deal Created */}\r\n                            <div className=\"relative\">\r\n                                <div className=\"absolute -left-[39px] w-6 h-6 bg-green-100 rounded-full border-2 border-white flex items-center justify-center\">\r\n                                    <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                                </div>\r\n                                <p className=\"text-xs text-gray-400 mb-1\">\r\n                                    {deal?.created_at ? new Date(deal.created_at).toLocaleString() : \"Fecha desconocida\"}\r\n                                </p>\r\n                                <p className=\"text-gray-800 font-medium\">Negocio creado</p>\r\n                            </div>\r\n\r\n                            {(!activities || activities.length === 0) && (\r\n                                <div className=\"relative opacity-50\">\r\n                                    <div className=\"absolute -left-[39px] w-6 h-6 bg-gray-100 rounded-full border-2 border-white flex items-center justify-center\">\r\n                                        <div className=\"w-2 h-2 bg-gray-400 rounded-full\"></div>\r\n                                    </div>\r\n                                    <p className=\"text-gray-400 font-medium italic\">No hay m√°s actividades registradas.</p>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right Column: Properties */}\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n                        <div className=\"flex justify-between items-center mb-4\">\r\n                            <h3 className=\"font-bold text-gray-800\">Detalles</h3>\r\n                            <button\r\n                                onClick={() => setIsEditModalOpen(true)}\r\n                                className=\"text-[#00AEEF] hover:bg-blue-50 p-1 rounded-md transition-colors\"\r\n                            >\r\n                                <Edit2 size={16} />\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"space-y-4\">\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-400 uppercase tracking-wider\">Cierre Esperado</label>\r\n                                <p className=\"text-gray-800 font-medium mt-1\">\r\n                                    {deal.expectedCloseDate ? new Date(deal.expectedCloseDate).toLocaleDateString() : \"No definido\"}\r\n                                </p>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-xs font-bold text-gray-400 uppercase tracking-wider\">Propietario</label>\r\n                                <div className=\"flex items-center gap-2 mt-1\">\r\n                                    <div className=\"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-bold text-blue-600\">You</div>\r\n                                    <p className=\"text-gray-800 font-medium\">Usuario</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\deals\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\integrations\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchStats'. Either include it or remove the dependency array.","line":14,"column":8,"nodeType":"ArrayExpression","endLine":14,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchStats]","fix":{"range":[477,479],"text":"[fetchStats]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nexport const dynamic = 'force-dynamic';\r\n\r\nimport Link from \"next/link\";\r\nimport { ArrowRight, Users, DollarSign, Calendar } from \"lucide-react\";\r\nimport { useDashboardStats } from \"@/hooks/useDashboardStats\";\r\nimport { useEffect } from \"react\";\r\n\r\nexport default function DashboardPage() {\r\n    const { activeDeals, pipelineValue, totalContacts, pendingTasks, fetchStats, loading } = useDashboardStats();\r\n\r\n    useEffect(() => {\r\n        fetchStats();\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fadeIn\">\r\n            {/* Welcome Hero */}\r\n            <div className=\"bg-gradient-to-r from-[#004A8D] to-[#00AEEF] rounded-2xl p-8 text-white shadow-lg relative overflow-hidden\">\r\n                <div className=\"relative z-10\">\r\n                    <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: 'Montserrat, sans-serif' }}>\r\n                        ¬°Hola, Usuario! üëã\r\n                    </h1>\r\n                    <p className=\"opacity-90 max-w-xl\">\r\n                        Aqu√≠ tienes el pulso de tu negocio hoy. Tienes <b>{pendingTasks} tareas</b> pendientes y <b>${pipelineValue.toLocaleString()}</b> en oportunidades activas.\r\n                    </p>\r\n                    <div className=\"mt-6 flex gap-3\">\r\n                        <Link href=\"/dashboard/deals\" className=\"bg-white/20 hover:bg-white/30 backdrop-blur-sm px-4 py-2 rounded-lg text-sm font-semibold transition-colors border border-white/30 flex items-center gap-2\">\r\n                            Ir al Pipeline <ArrowRight size={16} />\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n                {/* Abstract Deco */}\r\n                <div className=\"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2\" />\r\n                <div className=\"absolute bottom-0 right-20 w-32 h-32 bg-green-400/20 rounded-full blur-2xl\" />\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div id=\"dashboard-stats\" className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n                {/* Card 1: Active Deals */}\r\n                <div className=\"bg-white p-6 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden\">\r\n                    {loading && <div className=\"absolute inset-0 bg-white/50 backdrop-blur-[1px] z-10 animate-pulse\" />}\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                        <div className=\"p-2 bg-blue-50 text-blue-600 rounded-lg\"><BriefcaseIcon /></div>\r\n                        <span className=\"text-xs font-bold text-green-500 bg-green-50 px-2 py-1 rounded-full\">+100%</span>\r\n                    </div>\r\n                    <p className=\"text-sm font-medium text-gray-500\">Negocios Activos</p>\r\n                    <p className=\"text-2xl font-bold text-gray-800\">{activeDeals}</p>\r\n                </div>\r\n\r\n                {/* Card 2: Pipeline Value */}\r\n                <div className=\"bg-white p-6 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden\">\r\n                    {loading && <div className=\"absolute inset-0 bg-white/50 backdrop-blur-[1px] z-10 animate-pulse\" />}\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                        <div className=\"p-2 bg-green-50 text-green-600 rounded-lg\"><DollarSign size={20} /></div>\r\n                        <span className=\"text-xs font-bold text-green-500 bg-green-50 px-2 py-1 rounded-full\">+100%</span>\r\n                    </div>\r\n                    <p className=\"text-sm font-medium text-gray-500\">Valor en Pipeline</p>\r\n                    <p className=\"text-2xl font-bold text-gray-800\">${pipelineValue.toLocaleString()}</p>\r\n                </div>\r\n\r\n                {/* Card 3: Total Contacts */}\r\n                <div className=\"bg-white p-6 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden\">\r\n                    {loading && <div className=\"absolute inset-0 bg-white/50 backdrop-blur-[1px] z-10 animate-pulse\" />}\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                        <div className=\"p-2 bg-purple-50 text-purple-600 rounded-lg\"><Users size={20} /></div>\r\n                        <span className=\"text-xs font-medium text-gray-400\">Total</span>\r\n                    </div>\r\n                    <p className=\"text-sm font-medium text-gray-500\">Contactos</p>\r\n                    <p className=\"text-2xl font-bold text-gray-800\">{totalContacts}</p>\r\n                </div>\r\n\r\n                {/* Card 4: Tasks (Static/API Pending) */}\r\n                <div className=\"bg-white p-6 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow\">\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                        <div className=\"p-2 bg-orange-50 text-orange-600 rounded-lg\"><Calendar size={20} /></div>\r\n                        <span className=\"text-xs font-bold text-orange-500 bg-orange-50 px-2 py-1 rounded-full\">!</span>\r\n                    </div>\r\n                    <p className=\"text-sm font-medium text-gray-500\">Tareas Pendientes</p>\r\n                    <p className=\"text-2xl font-bold text-gray-800\">{pendingTasks}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction BriefcaseIcon() {\r\n    return (\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><rect width=\"20\" height=\"14\" x=\"2\" y=\"7\" rx=\"2\" ry=\"2\" /><path d=\"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16\" /></svg>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\settings\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[579,582],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[579,582],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Settings, User, Shield, Bell, Database, ChevronLeft } from \"lucide-react\";\r\nimport ProfileSettings from \"@/components/settings/ProfileSettings\";\r\nimport PipelineSettings from \"@/components/settings/PipelineSettings\";\r\nimport SecuritySettings from \"@/components/settings/SecuritySettings\";\r\nimport NotificationSettings from \"@/components/settings/NotificationSettings\";\r\n\r\ntype SettingView = \"main\" | \"profile\" | \"security\" | \"notifications\" | \"pipeline\";\r\n\r\ninterface SettingSection {\r\n    id: SettingView;\r\n    icon: any;\r\n    title: string;\r\n    desc: string;\r\n    status: \"Activo\" | \"Pr√≥ximamente\";\r\n}\r\n\r\nexport default function SettingsPage() {\r\n    const [activeView, setActiveView] = useState<SettingView>(\"main\");\r\n\r\n    const sections: SettingSection[] = [\r\n        { id: \"profile\", icon: User, title: \"Perfil de Usuario\", desc: \"Gestiona tu informaci√≥n personal y avatar.\", status: \"Activo\" },\r\n        { id: \"pipeline\", icon: Database, title: \"Datos & Pipeline\", desc: \"Personaliza las etapas de tu embudo de ventas.\", status: \"Activo\" },\r\n        { id: \"security\", icon: Shield, title: \"Seguridad & Acceso\", desc: \"Cambia tu contrase√±a y protege tu cuenta.\", status: \"Activo\" },\r\n        { id: \"notifications\", icon: Bell, title: \"Notificaciones\", desc: \"Configura qu√© alertas quieres recibir.\", status: \"Activo\" },\r\n    ];\r\n\r\n    if (activeView !== \"main\") {\r\n        const viewConfigs = {\r\n            profile: { title: \"Perfil de Usuario üë§\", desc: \"Personaliza c√≥mo te ven tus colegas y clientes.\", component: <ProfileSettings /> },\r\n            security: { title: \"Seguridad & Acceso üîê\", desc: \"Gestiona tu contrase√±a y la seguridad de tu cuenta.\", component: <SecuritySettings /> },\r\n            notifications: { title: \"Notificaciones üîî\", desc: \"Configura c√≥mo quieres ser alertado por el sistema.\", component: <NotificationSettings /> },\r\n            pipeline: { title: \"Datos & Pipeline üìä\", desc: \"Gestiona la columna vertebral de tu proceso comercial.\", component: <PipelineSettings /> },\r\n        };\r\n\r\n        const current = viewConfigs[activeView as keyof typeof viewConfigs];\r\n\r\n        return (\r\n            <div className=\"space-y-8 animate-fadeIn\">\r\n                <button\r\n                    onClick={() => setActiveView(\"main\")}\r\n                    className=\"flex items-center gap-2 text-gray-400 hover:text-[#00AEEF] transition-colors text-sm font-bold group\"\r\n                >\r\n                    <ChevronLeft size={18} className=\"group-hover:-translate-x-1 transition-transform\" />\r\n                    Volver a Ajustes\r\n                </button>\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-gray-800\" style={{ fontFamily: 'Montserrat, sans-serif' }}>\r\n                        {current.title}\r\n                    </h1>\r\n                    <p className=\"text-gray-500 mt-2\">{current.desc}</p>\r\n                </div>\r\n                <div className=\"bg-white p-8 rounded-3xl border border-gray-100 shadow-sm\">\r\n                    {current.component}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fadeIn\">\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold text-gray-800\" style={{ fontFamily: 'Montserrat, sans-serif' }}>\r\n                    Configuraci√≥n ‚öôÔ∏è\r\n                </h1>\r\n                <p className=\"text-gray-500 mt-2\">Personaliza CunemoClient para que se adapte a tu forma de trabajar.</p>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden\">\r\n                <div className=\"divide-y divide-gray-50\">\r\n                    {sections.map((s) => (\r\n                        <div\r\n                            key={s.id}\r\n                            onClick={() => s.status === \"Activo\" && setActiveView(s.id)}\r\n                            className={`p-6 flex items-center justify-between transition-colors group ${s.status === \"Activo\" ? \"hover:bg-gray-50 cursor-pointer\" : \"opacity-60 cursor-not-allowed\"}`}\r\n                        >\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <div className={`p-3 rounded-xl transition-colors ${s.status === \"Activo\" ? \"bg-gray-50 text-gray-400 group-hover:bg-blue-50 group-hover:text-[#00AEEF]\" : \"bg-gray-50 text-gray-300\"}`}>\r\n                                    <s.icon size={20} />\r\n                                </div>\r\n                                <div>\r\n                                    <h4 className={`font-bold text-sm transition-colors ${s.status === \"Activo\" ? \"text-gray-800 group-hover:text-[#004A8D]\" : \"text-gray-400\"}`}>{s.title}</h4>\r\n                                    <p className=\"text-xs text-gray-500\">{s.desc}</p>\r\n                                </div>\r\n                            </div>\r\n                            <span className={`text-[10px] font-bold uppercase tracking-widest transition-colors ${s.status === 'Activo' ? 'text-[#00AEEF] group-hover:text-[#004A8D]' : 'text-gray-300'}`}>\r\n                                {s.status === \"Activo\" ? \"Gestionar\" : \"Pr√≥ximamente\"}\r\n                            </span>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 bg-gradient-to-r from-gray-50 to-white rounded-2xl border border-gray-100 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Settings className=\"text-gray-300\" size={20} />\r\n                    <span className=\"text-sm text-gray-500 font-medium\">Versi√≥n del Sistema: 1.2.0-Fase2</span>\r\n                </div>\r\n                <button className=\"text-[#00AEEF] text-xs font-bold hover:underline\">Ver registro de cambios</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\dashboard\\tickets\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\onboarding\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[936,939],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[936,939],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nexport const dynamic = 'force-dynamic';\n\nimport { useState } from \"react\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { supabase } from \"@/lib/supabase\";\nimport \"./globals.css\";\n\nexport default function Home() {\n  const router = useRouter();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleLogin = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    const formData = new FormData(e.currentTarget);\n    const email = formData.get(\"email\") as string;\n    const password = formData.get(\"password\") as string;\n\n    try {\n      const { error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n\n      if (error) throw error;\n\n      router.push(\"/dashboard\");\n    } catch (err: any) {\n      console.error(\"Error de login:\", err);\n      setError(\"Credenciales inv√°lidas. Por favor verifica tu correo y contrase√±a.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"split-login-container\">\n      {/* Panel Izquierdo - Formulario */}\n      <div className=\"login-left-panel\">\n        <div className=\"login-form-wrapper\">\n          <div className=\"mb-8\">\n            <h1\n              style={{\n                fontFamily: \"Montserrat, sans-serif\",\n                fontSize: \"2.25rem\",\n                fontWeight: 700,\n                color: \"#004A8D\",\n                marginBottom: \"0.5rem\",\n              }}\n            >\n              CunemoClient\n            </h1>\n            <p className=\"text-gray-600\" style={{ fontSize: \"1rem\" }}>\n              Gesti√≥n inteligente de relaciones con clientes\n            </p>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 text-red-600 p-3 rounded-md text-sm mb-4 border border-red-100\">\n              {error}\n            </div>\n          )}\n\n          <form onSubmit={handleLogin} className=\"space-y-4\">\n            <div>\n              <label\n                htmlFor=\"email\"\n                className=\"block text-sm font-medium text-gray-700 mb-1\"\n              >\n                Correo Electr√≥nico\n              </label>\n              <input\n                name=\"email\"\n                id=\"email\"\n                type=\"email\"\n                placeholder=\"tu@empresa.com\"\n                required\n                disabled={loading}\n              />\n            </div>\n\n            <div>\n              <label\n                htmlFor=\"password\"\n                className=\"block text-sm font-medium text-gray-700 mb-1\"\n              >\n                Contrase√±a\n              </label>\n              <input\n                name=\"password\"\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                required\n                disabled={loading}\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              className=\"btn-primary w-full\"\n              disabled={loading}\n              style={{ opacity: loading ? 0.7 : 1 }}\n            >\n              {loading ? \"Iniciando sesi√≥n...\" : \"Iniciar Sesi√≥n\"}\n            </button>\n          </form>\n\n          <p className=\"text-center text-sm text-gray-600 mt-6\">\n            ¬øNo tienes cuenta?{\" \"}\n            <Link href=\"/register\" style={{ color: \"#00AEEF\", fontWeight: 500 }}>\n              Reg√≠strate aqu√≠\n            </Link>\n          </p>\n        </div>\n      </div>\n\n      {/* Panel Derecho - Imagen */}\n      <div className=\"login-right-panel\">\n        <div className=\"image-overlay\"></div>\n        <div className=\"image-container\">\n          <Image\n            src=\"/material/312.png\"\n            alt=\"CRM Dashboard\"\n            fill\n            style={{ objectFit: \"contain\", objectPosition: \"center\" }}\n            priority\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\app\\register\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":132,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4370,4373],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4370,4373],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nexport const dynamic = 'force-dynamic';\r\n\r\nimport { useState } from \"react\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport \"../globals.css\";\r\n\r\nexport default function Register() {\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(false);\r\n    const [step, setStep] = useState(1); // 1: Credenciales, 2: Perfil, 3: Empresa\r\n    const [formData, setFormData] = useState({\r\n        email: \"\",\r\n        password: \"\",\r\n        confirmPassword: \"\",\r\n        name: \"\",\r\n        phone: \"\",\r\n        company: \"\",\r\n        terms: false,\r\n    });\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value, type, checked } = e.target;\r\n        setFormData((prev) => ({\r\n            ...prev,\r\n            [name]: type === \"checkbox\" ? checked : value,\r\n        }));\r\n    };\r\n\r\n    const validateStep1 = () => {\r\n        if (!formData.email || !formData.password || !formData.confirmPassword) {\r\n            setError(\"Por favor completa todos los campos.\");\r\n            return false;\r\n        }\r\n        if (formData.password !== formData.confirmPassword) {\r\n            setError(\"Las contrase√±as no coinciden.\");\r\n            return false;\r\n        }\r\n        if (formData.password.length < 6) {\r\n            setError(\"La contrase√±a debe tener al menos 6 caracteres.\");\r\n            return false;\r\n        }\r\n        setError(null);\r\n        return true;\r\n    };\r\n\r\n    const validateStep2 = () => {\r\n        if (!formData.name || !formData.phone) {\r\n            setError(\"Por favor completa tu perfil.\");\r\n            return false;\r\n        }\r\n        setError(null);\r\n        return true;\r\n    };\r\n\r\n    const validateStep3 = () => {\r\n        if (!formData.company) {\r\n            setError(\"El nombre de la empresa es obligatorio.\");\r\n            return false;\r\n        }\r\n        if (!formData.terms) {\r\n            setError(\"Debes aceptar los T√©rminos y Condiciones.\");\r\n            return false;\r\n        }\r\n        setError(null);\r\n        return true;\r\n    };\r\n\r\n    const nextStep = () => {\r\n        if (step === 1 && validateStep1()) setStep(2);\r\n        if (step === 2 && validateStep2()) setStep(3);\r\n    };\r\n\r\n    const prevStep = () => setStep(step - 1);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!validateStep3()) return;\r\n\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n            // 1. Auth: Crear usuario\r\n            const { data: authData, error: authError } = await supabase.auth.signUp({\r\n                email: formData.email,\r\n                password: formData.password,\r\n                options: {\r\n                    data: {\r\n                        full_name: formData.name,\r\n                        company_name: formData.company,\r\n                    },\r\n                },\r\n            });\r\n\r\n            if (authError) throw authError;\r\n            if (!authData.user) throw new Error(\"No se pudo crear el usuario\");\r\n\r\n            // 2. Company: Crear registro en accounts\r\n            const { data: accountData, error: accountError } = await supabase\r\n                .from(\"accounts\")\r\n                .insert([{ name: formData.company, phone: formData.phone }])\r\n                .select()\r\n                .single();\r\n\r\n            if (accountError) throw accountError;\r\n\r\n            // 3. Contact: Crear admin en contacts\r\n            const nameParts = formData.name.split(\" \");\r\n            const firstName = nameParts[0];\r\n            const lastName = nameParts.slice(1).join(\" \") || \"\";\r\n\r\n            const { error: contactError } = await supabase.from(\"contacts\").insert([\r\n                {\r\n                    account_id: accountData.id,\r\n                    first_name: firstName,\r\n                    last_name: lastName,\r\n                    email: formData.email,\r\n                    phone: formData.phone,\r\n                    job_title: \"Administrador\",\r\n                },\r\n            ]);\r\n\r\n            if (contactError) throw contactError;\r\n\r\n            alert(\"¬°Cuenta creada exitosamente! Bienvenido a CunemoClient.\");\r\n            router.push(\"/\");\r\n        } catch (err: any) {\r\n            console.error(\"Error:\", err);\r\n            setError(err.message || \"Error al crear la cuenta\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"split-login-container\">\r\n            {/* Left Panel */}\r\n            <div className=\"login-left-panel\">\r\n                <div className=\"login-form-wrapper\">\r\n                    {/* Header */}\r\n                    <div className=\"mb-6\">\r\n                        <h1 style={{ fontFamily: \"Montserrat\", fontSize: \"2rem\", fontWeight: 700, color: \"#004A8D\" }}>\r\n                            Crear Cuenta\r\n                        </h1>\r\n                        <p className=\"text-gray-500 text-sm mt-1\">\r\n                            Paso {step} de 3: {step === 1 ? \"Credenciales\" : step === 2 ? \"Perfil Personal\" : \"Tu Empresa\"}\r\n                        </p>\r\n                        {/* Progress Bar */}\r\n                        <div className=\"w-full h-1 bg-gray-200 mt-4 rounded-full overflow-hidden\">\r\n                            <div\r\n                                className=\"h-full bg-[#8DC63F] transition-all duration-300 ease-out\"\r\n                                style={{ width: `${(step / 3) * 100}%` }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {error && (\r\n                        <div className=\"bg-red-50 text-red-600 p-3 rounded-md text-sm mb-4 border border-red-100 flex items-center gap-2\">\r\n                            ‚ö†Ô∏è {error}\r\n                        </div>\r\n                    )}\r\n\r\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                        {/* STEP 1: Credenciales */}\r\n                        {step === 1 && (\r\n                            <div className=\"space-y-4 animate-fadeIn\">\r\n                                <div>\r\n                                    <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1\">Email Corporativo</label>\r\n                                    <input\r\n                                        name=\"email\"\r\n                                        type=\"email\"\r\n                                        value={formData.email}\r\n                                        onChange={handleChange}\r\n                                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent transition-all outline-none\"\r\n                                        placeholder=\"nombre@empresa.com\"\r\n                                        autoFocus\r\n                                    />\r\n                                </div>\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1\">Contrase√±a</label>\r\n                                        <input\r\n                                            name=\"password\"\r\n                                            type=\"password\"\r\n                                            value={formData.password}\r\n                                            onChange={handleChange}\r\n                                            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent transition-all outline-none\"\r\n                                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1\">Confirmar</label>\r\n                                        <input\r\n                                            name=\"confirmPassword\"\r\n                                            type=\"password\"\r\n                                            value={formData.confirmPassword}\r\n                                            onChange={handleChange}\r\n                                            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent transition-all outline-none\"\r\n                                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={nextStep}\r\n                                    className=\"btn-primary w-full mt-2\"\r\n                                >\r\n                                    Continuar\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* STEP 2: Perfil */}\r\n                        {step === 2 && (\r\n                            <div className=\"space-y-4 animate-fadeIn\">\r\n                                <div>\r\n                                    <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1\">Nombre Completo</label>\r\n                                    <input\r\n                                        name=\"name\"\r\n                                        type=\"text\"\r\n                                        value={formData.name}\r\n                                        onChange={handleChange}\r\n                                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent transition-all outline-none\"\r\n                                        placeholder=\"Ej. Ana Garc√≠a\"\r\n                                        autoFocus\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1\">Tel√©fono / M√≥vil</label>\r\n                                    <input\r\n                                        name=\"phone\"\r\n                                        type=\"tel\"\r\n                                        value={formData.phone}\r\n                                        onChange={handleChange}\r\n                                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent transition-all outline-none\"\r\n                                        placeholder=\"+51 900 000 000\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"flex gap-3 mt-4\">\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={prevStep}\r\n                                        className=\"flex-1 p-3 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium\"\r\n                                    >\r\n                                        Atr√°s\r\n                                    </button>\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={nextStep}\r\n                                        className=\"flex-1 btn-primary\"\r\n                                    >\r\n                                        Siguiente\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* STEP 3: Empresa */}\r\n                        {step === 3 && (\r\n                            <div className=\"space-y-4 animate-fadeIn\">\r\n                                <div>\r\n                                    <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1\">Nombre de la Empresa</label>\r\n                                    <input\r\n                                        name=\"company\"\r\n                                        type=\"text\"\r\n                                        value={formData.company}\r\n                                        onChange={handleChange}\r\n                                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00AEEF] focus:border-transparent transition-all outline-none\"\r\n                                        placeholder=\"Ej. Tecnolog√≠as S.A.C.\"\r\n                                        autoFocus\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"flex items-start gap-3 p-4 bg-blue-50 rounded-lg border border-blue-100\">\r\n                                    <input\r\n                                        id=\"terms\"\r\n                                        name=\"terms\"\r\n                                        type=\"checkbox\"\r\n                                        checked={formData.terms}\r\n                                        onChange={handleChange}\r\n                                        className=\"mt-1 w-4 h-4 text-[#00AEEF] rounded focus:ring-[#00AEEF]\"\r\n                                    />\r\n                                    <label htmlFor=\"terms\" className=\"text-xs text-gray-600 leading-relaxed\">\r\n                                        Al crear una cuenta, aceptas nuestros <a href=\"#\" className=\"text-[#00AEEF] font-semibold hover:underline\">T√©rminos de Servicio</a> y <a href=\"#\" className=\"text-[#00AEEF] font-semibold hover:underline\">Pol√≠tica de Privacidad</a>.\r\n                                    </label>\r\n                                </div>\r\n\r\n                                <div className=\"flex gap-3 mt-4\">\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={prevStep}\r\n                                        className=\"flex-1 p-3 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium\"\r\n                                    >\r\n                                        Atr√°s\r\n                                    </button>\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        disabled={loading}\r\n                                        className=\"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                    >\r\n                                        {loading ? \"Registrando...\" : \"Finalizar Registro\"}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </form>\r\n\r\n                    {step === 1 && (\r\n                        <p className=\"text-center text-sm text-gray-500 mt-8\">\r\n                            ¬øYa tienes cuenta?{\" \"}\r\n                            <Link href=\"/\" className=\"text-[#00AEEF] font-semibold hover:underline\">\r\n                                Inicia sesi√≥n aqu√≠\r\n                            </Link>\r\n                        </p>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Right Panel */}\r\n            <div className=\"login-right-panel\">\r\n                <div className=\"image-overlay\"></div>\r\n                <div className=\"image-container\">\r\n                    <Image\r\n                        src=\"/material/312.png\"\r\n                        alt=\"CRM Dashboard\"\r\n                        fill\r\n                        style={{ objectFit: \"contain\", objectPosition: \"center\" }}\r\n                        priority\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\companies\\NewCompanyModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\contacts\\NewContactModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\dashboard\\NotificationCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\deals\\ActivityModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\deals\\EditDealModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\integrations\\ComingSoonIntegration.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[171,174],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[171,174],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { ArrowLeft, Rocket, CheckCircle2, ShieldCheck, Zap } from \"lucide-react\";\r\n\r\ninterface ComingSoonIntegrationProps {\r\n    name: string;\r\n    icon: any;\r\n    color: string;\r\n    features: string[];\r\n    onBack: () => void;\r\n}\r\n\r\nexport default function ComingSoonIntegration({ name, icon: Icon, color, features, onBack }: ComingSoonIntegrationProps) {\r\n    return (\r\n        <div className=\"space-y-8 animate-fadeIn\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4\">\r\n                <button\r\n                    onClick={onBack}\r\n                    className=\"p-2 hover:bg-gray-100 rounded-xl transition-colors text-gray-400 hover:text-gray-600\"\r\n                >\r\n                    <ArrowLeft size={20} />\r\n                </button>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-800\">{name}</h2>\r\n                    <p className=\"text-sm text-gray-500\">Pr√≥ximamente en Anderson CRM.</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden\">\r\n                <div className=\"p-12 text-center space-y-8\">\r\n                    <div className={`w-24 h-24 mx-auto rounded-3xl flex items-center justify-center bg-gray-50 ${color} shadow-inner`}>\r\n                        <Icon size={48} />\r\n                    </div>\r\n\r\n                    <div className=\"max-w-md mx-auto space-y-4\">\r\n                        <div className=\"inline-flex items-center gap-2 bg-blue-50 text-blue-600 text-[10px] font-black px-3 py-1.5 rounded-full uppercase tracking-widest\">\r\n                            <Rocket size={12} /> Fase de Desarrollo\r\n                        </div>\r\n                        <h3 className=\"text-3xl font-bold text-gray-800\">Estamos construyendo algo grande</h3>\r\n                        <p className=\"text-sm text-gray-500 leading-relaxed\">\r\n                            La integraci√≥n con {name} est√° en nuestra prioridad #1. Muy pronto podr√°s automatizar tu flujo de trabajo sin salir del CRM.\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto pt-8\">\r\n                        {features.map((feature, i) => (\r\n                            <div key={i} className=\"p-4 bg-gray-50/50 rounded-2xl border border-gray-50 flex flex-col items-center gap-3 text-center\">\r\n                                <CheckCircle2 className=\"text-green-500\" size={20} />\r\n                                <span className=\"text-xs font-medium text-gray-600 leading-tight\">{feature}</span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"pt-12 border-t border-gray-50 max-w-lg mx-auto\">\r\n                        <div className=\"flex items-center justify-center gap-8 mb-8\">\r\n                            <div className=\"text-center\">\r\n                                <div className=\"text-2xl font-bold text-gray-300\">85%</div>\r\n                                <div className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest\">Infraestructura</div>\r\n                            </div>\r\n                            <div className=\"w-px h-8 bg-gray-100\" />\r\n                            <div className=\"text-center\">\r\n                                <div className=\"text-2xl font-bold text-gray-300\">40%</div>\r\n                                <div className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest\">Interfaz</div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button\r\n                            disabled\r\n                            className=\"w-full py-4 bg-gray-100 text-gray-400 font-bold rounded-2xl flex items-center justify-center gap-2 cursor-not-allowed\"\r\n                        >\r\n                            <Zap size={18} /> Notificarme cuando est√© listo\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-gray-50 p-6 flex items-center justify-center gap-8 border-t border-gray-100 opacity-50\">\r\n                    <div className=\"flex items-center gap-2 text-xs font-medium text-gray-400\">\r\n                        <ShieldCheck size={16} /> Seguridad Verificada\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 text-xs font-medium text-gray-400\">\r\n                        <Zap size={16} /> API de Alto Rendimiento\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\integrations\\EmailIntegration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\integrations\\GoogleCalendarIntegration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\integrations\\WhatsAppIntegration.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MessageSquare"},"fix":{"range":[61,75],"text":""},"desc":"Remove unused variable \"MessageSquare\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":4,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":31,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Shield"},"fix":{"range":[74,82],"text":""},"desc":"Remove unused variable \"Shield\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Smartphone' is defined but never used.","line":4,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":67,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Smartphone"},"fix":{"range":[106,118],"text":""},"desc":"Remove unused variable \"Smartphone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":4,"column":75,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":82,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Loader2"},"fix":{"range":[124,133],"text":""},"desc":"Remove unused variable \"Loader2\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { MessageSquare, Shield, Zap, CheckCircle, Code, Smartphone, Info, Loader2, ArrowLeft } from \"lucide-react\";\r\n\r\ninterface WhatsAppIntegrationProps {\r\n    onBack: () => void;\r\n}\r\n\r\nexport default function WhatsAppIntegration({ onBack }: WhatsAppIntegrationProps) {\r\n    const [mode, setMode] = useState<\"select\" | \"byok\" | \"managed\">(\"select\");\r\n\r\n    const handleSelectMode = (newMode: \"byok\" | \"managed\") => {\r\n        setMode(newMode);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fadeIn\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4\">\r\n                <button\r\n                    onClick={onBack}\r\n                    className=\"p-2 hover:bg-gray-100 rounded-xl transition-colors text-gray-400 hover:text-gray-600\"\r\n                >\r\n                    <ArrowLeft size={20} />\r\n                </button>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-800\">Configurar WhatsApp API</h2>\r\n                    <p className=\"text-sm text-gray-500\">Automatiza tus ventas y centraliza tus chats en un solo lugar.</p>\r\n                </div>\r\n            </div>\r\n\r\n            {mode === \"select\" && (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    {/* Opci√≥n BYOK */}\r\n                    <div\r\n                        onClick={() => handleSelectMode(\"byok\")}\r\n                        className=\"bg-white p-8 rounded-3xl border-2 border-gray-100 hover:border-blue-200 cursor-pointer transition-all hover:shadow-xl group\"\r\n                    >\r\n                        <div className=\"w-14 h-14 bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform\">\r\n                            <Code size={28} />\r\n                        </div>\r\n                        <h3 className=\"text-xl font-bold text-gray-800 mb-2\">Trae tu propia API</h3>\r\n                        <p className=\"text-sm text-gray-500 leading-relaxed mb-6\">\r\n                            Si ya tienes una cuenta de Desarrollador en Meta o usas un bot propio. Conecta CunemoClient sin cargos adicionales de nuestra parte.\r\n                        </p>\r\n                        <ul className=\"space-y-3 mb-8\">\r\n                            <li className=\"flex items-center gap-2 text-xs text-gray-600\">\r\n                                <CheckCircle size={14} className=\"text-green-500\" /> Control total de tus llaves\r\n                            </li>\r\n                            <li className=\"flex items-center gap-2 text-xs text-gray-600\">\r\n                                <CheckCircle size={14} className=\"text-green-500\" /> Pagas directo a Meta\r\n                            </li>\r\n                            <li className=\"flex items-center gap-2 text-xs text-gray-600\">\r\n                                <CheckCircle size={14} className=\"text-green-500\" /> Sin costo por integraci√≥n\r\n                            </li>\r\n                        </ul>\r\n                        <button className=\"w-full py-3 bg-gray-50 text-gray-600 font-bold rounded-xl group-hover:bg-[#00AEEF] group-hover:text-white transition-colors\">\r\n                            Configurar manualmente\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Opci√≥n Managed */}\r\n                    <div\r\n                        onClick={() => {/* handleSelectMode(\"managed\") */ }}\r\n                        className=\"bg-[#004A8D] p-8 rounded-3xl border-2 border-[#004A8D] cursor-not-allowed opacity-90 transition-all shadow-blue-900/20 group relative overflow-hidden\"\r\n                    >\r\n                        <div className=\"absolute top-4 right-4 flex gap-2\">\r\n                            <div className=\"bg-yellow-400 text-blue-900 text-[10px] font-black px-2 py-1 rounded-full uppercase tracking-widest\">\r\n                                Recomendado\r\n                            </div>\r\n                            <div className=\"bg-white/20 text-white text-[10px] font-black px-2 py-1 rounded-full uppercase tracking-widest border border-white/30 backdrop-blur-sm\">\r\n                                Pr√≥ximamente\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"w-14 h-14 bg-white/10 text-white rounded-2xl flex items-center justify-center mb-6\">\r\n                            <Zap size={28} />\r\n                        </div>\r\n                        <h3 className=\"text-xl font-bold text-white mb-2\">Cunemo Premium</h3>\r\n                        <p className=\"text-sm text-white/70 leading-relaxed mb-6\">\r\n                            Nosotros nos encargamos de todo. Sin configuraciones t√©cnicas. Activa WhatsApp en 5 minutos y empieza a vender.\r\n                        </p>\r\n                        <ul className=\"space-y-3 mb-8\">\r\n                            <li className=\"flex items-center gap-2 text-xs text-white/80\">\r\n                                <CheckCircle size={14} className=\"text-yellow-400\" /> Activaci√≥n instant√°nea\r\n                            </li>\r\n                            <li className=\"flex items-center gap-2 text-xs text-white/80\">\r\n                                <CheckCircle size={14} className=\"text-yellow-400\" /> Soporte t√©cnico incluido\r\n                            </li>\r\n                            <li className=\"flex items-center gap-2 text-xs text-white/80\">\r\n                                <CheckCircle size={14} className=\"text-yellow-400\" /> Inbox unificado gratis\r\n                            </li>\r\n                        </ul>\r\n                        <button disabled className=\"w-full py-3 bg-white/10 text-white/50 font-bold rounded-xl border border-white/20\">\r\n                            Pr√≥ximamente\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {mode === \"byok\" && (\r\n                <div className=\"bg-white p-8 rounded-3xl border border-gray-100 shadow-sm space-y-8 animate-fadeIn\">\r\n                    <div className=\"flex items-start gap-4 p-4 bg-orange-50 rounded-2xl border border-orange-100 text-orange-800\">\r\n                        <Info size={20} className=\"shrink-0 mt-1\" />\r\n                        <div className=\"text-xs space-y-1\">\r\n                            <p className=\"font-bold\">Requiere cuenta de Meta for Developers</p>\r\n                            <p className=\"opacity-80\">Necesitar√°s tu App ID, ID de Tel√©fono y un Token de Acceso Permanente.</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <form className=\"space-y-6 max-w-lg\">\r\n                        <div className=\"grid grid-cols-1 gap-6\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest\">Phone Number ID</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Ej: 10593452243...\"\r\n                                    className=\"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl outline-none focus:ring-2 focus:ring-[#00AEEF] text-sm\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest\">WhatsApp Business Account ID</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Ej: 114322522...\"\r\n                                    className=\"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl outline-none focus:ring-2 focus:ring-[#00AEEF] text-sm\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest\">Permanent Access Token</label>\r\n                                <textarea\r\n                                    rows={3}\r\n                                    placeholder=\"Pega aqu√≠ tu token permanente...\"\r\n                                    className=\"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl outline-none focus:ring-2 focus:ring-[#00AEEF] text-sm\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"pt-4 flex items-center gap-4\">\r\n                            <button className=\"btn-primary px-8\">Guardar y Vincular</button>\r\n                            <button\r\n                                onClick={() => setMode(\"select\")}\r\n                                className=\"text-xs font-bold text-gray-400 hover:text-gray-600 px-4 py-2\"\r\n                            >\r\n                                Cancelar\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            )}\r\n\r\n            {mode === \"managed\" && (\r\n                <div className=\"bg-white p-8 rounded-3xl border border-gray-100 shadow-sm text-center space-y-8 animate-fadeIn\">\r\n                    <div className=\"max-w-md mx-auto space-y-4\">\r\n                        <div className=\"w-20 h-20 bg-blue-50 text-[#004A8D] rounded-full flex items-center justify-center mx-auto mb-6\">\r\n                            <Zap size={40} className=\"fill-current\" />\r\n                        </div>\r\n                        <h3 className=\"text-2xl font-bold text-gray-800\">¬°Excelente elecci√≥n!</h3>\r\n                        <p className=\"text-sm text-gray-500\">\r\n                            Est√°s a un paso de automatizar tu comunicaci√≥n. El plan Premium incluye:\r\n                        </p>\r\n                        <div className=\"bg-gray-50 p-6 rounded-2xl text-left space-y-4\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <CheckCircle className=\"text-green-500\" size={18} />\r\n                                <span className=\"text-sm text-gray-700\">Meta API Costs Incluidos (hasta 1,000 conv/mes)</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <CheckCircle className=\"text-green-500\" size={18} />\r\n                                <span className=\"text-sm text-gray-700\">Multi-agente: Todos tus vendedores en un solo n√∫mero</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <CheckCircle className=\"text-green-500\" size={18} />\r\n                                <span className=\"text-sm text-gray-700\">Respuestas r√°pidas y Bots de calificaci√≥n b√°sica</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"pt-6 space-y-4\">\r\n                            <button className=\"w-full py-4 bg-[#004A8D] text-white font-bold rounded-2xl shadow-xl shadow-blue-500/20 hover:bg-blue-800 transition-colors\">\r\n                                Proceder al Pago Seguro\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setMode(\"select\")}\r\n                                className=\"text-xs font-bold text-gray-400 hover:text-gray-600 block mx-auto\"\r\n                            >\r\n                                Volver a opciones\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\layout\\CunemoGuide.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\layout\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\onboarding\\OnboardingWizard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1576,1579],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1576,1579],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport ProfileStep from \"./steps/ProfileStep\";\r\nimport FirstDealStep from \"./steps/FirstDealStep\";\r\nimport ContactSeedStep from \"./steps/ContactSeedStep\"; // Importado correctamente\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Check } from \"lucide-react\";\r\nimport { saveOnboardingData } from \"@/lib/actions/onboarding\"; // Importaremos esto luego\r\n\r\nexport default function OnboardingWizard() {\r\n    const [currentStep, setCurrentStep] = useState(1);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // Estado √∫nico para todo el wizard\r\n    const [formData, setFormData] = useState({\r\n        // Step 1: Profile\r\n        role: \"\",\r\n        industry: \"\",\r\n        currency: \"USD\",\r\n        // Step 2: Contacts\r\n        seedContacts: [],\r\n        // Step 3: First Deal\r\n        firstDeal: { title: \"\", value: \"\", probability: \"\" }\r\n    });\r\n\r\n    const router = useRouter();\r\n\r\n    const handleNext = () => {\r\n        if (currentStep < 3) {\r\n            setCurrentStep(prev => prev + 1);\r\n        } else {\r\n            handleFinalize();\r\n        }\r\n    };\r\n\r\n    const handleFinalize = async () => {\r\n        setLoading(true);\r\n        try {\r\n\r\n            await saveOnboardingData(formData);\r\n            router.push(\"/dashboard\");\r\n        } catch (error) {\r\n            console.error(\"Error saving onboarding:\", error);\r\n            alert(\"Hubo un error guardando tus datos. Revisa la consola.\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const updateData = (data: any) => {\r\n        setFormData(prev => ({ ...prev, ...data }));\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50 flex flex-col items-center pt-20 px-4\">\r\n            {/* Progress Header */}\r\n            <div className=\"w-full max-w-2xl mb-12\">\r\n                <div className=\"flex justify-between items-center relative\">\r\n                    {/* Progress Bar Background */}\r\n                    <div className=\"absolute left-0 top-1/2 -translate-y-1/2 w-full h-1 bg-gray-200 rounded-full -z-10\"></div>\r\n                    {/* Progress Bar Active */}\r\n                    <div\r\n                        className=\"absolute left-0 top-1/2 -translate-y-1/2 h-1 bg-[#00AEEF] rounded-full -z-10 transition-all duration-500 ease-out\"\r\n                        style={{ width: `${((currentStep - 1) / 2) * 100}%` }}\r\n                    ></div>\r\n\r\n                    {[1, 2, 3].map((step) => {\r\n                        const isActive = step === currentStep;\r\n                        const isCompleted = step < currentStep;\r\n\r\n                        return (\r\n                            <div\r\n                                key={step}\r\n                                className={`\r\n                            w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm transition-all duration-300 border-4\r\n                            ${isActive ? \"bg-white border-[#00AEEF] text-[#00AEEF] scale-110 shadow-lg\" : \"\"}\r\n                            ${isCompleted ? \"bg-[#00AEEF] border-[#00AEEF] text-white\" : \"\"}\r\n                            ${!isActive && !isCompleted ? \"bg-white border-gray-200 text-gray-400\" : \"\"}\r\n                        `}\r\n                            >\r\n                                {isCompleted ? <Check size={18} /> : step}\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n                <div className=\"flex justify-between text-xs font-medium text-gray-400 mt-2 px-1\">\r\n                    <span className={currentStep >= 1 ? \"text-[#004A8D]\" : \"\"}>Tu Perfil</span>\r\n                    <span className={currentStep >= 2 ? \"text-[#004A8D]\" : \"\"}>Contactos Clave</span>\r\n                    <span className={currentStep >= 3 ? \"text-[#004A8D]\" : \"\"}>Primer Negocio</span>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Step Content Card */}\r\n            <div className=\"w-full max-w-2xl bg-white rounded-2xl shadow-xl p-8 border border-gray-100 animate-fadeIn relative\">\r\n                {loading && (\r\n                    <div className=\"absolute inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center rounded-2xl\">\r\n                        <div className=\"flex flex-col items-center gap-3\">\r\n                            <div className=\"w-8 h-8 border-4 border-[#00AEEF] border-t-transparent rounded-full animate-spin\"></div>\r\n                            <p className=\"text-[#004A8D] font-bold\">Configurando tu CRM...</p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {currentStep === 1 && (\r\n                    <ProfileStep\r\n                        data={formData}\r\n                        updateData={updateData}\r\n                        onNext={handleNext}\r\n                    />\r\n                )}\r\n                {currentStep === 2 && (\r\n                    <ContactSeedStep\r\n                        updateData={updateData}\r\n                        onNext={handleNext}\r\n                    />\r\n                )}\r\n                {currentStep === 3 && (\r\n                    <FirstDealStep\r\n                        updateData={updateData}\r\n                        onNext={handleNext}\r\n                    />\r\n                )}\r\n            </div>\r\n\r\n            {/* Footer Helper */}\r\n            <p className=\"mt-8 text-gray-400 text-sm\">\r\n                Te tomar√° menos de 5 minutos. <span className=\"underline cursor-pointer hover:text-gray-600\">Omitir configuraci√≥n</span>\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\onboarding\\steps\\ContactSeedStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\onboarding\\steps\\FirstDealStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\onboarding\\steps\\ProfileStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\pipeline\\DealCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\pipeline\\KanbanBoard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'startCol' is assigned a value but never used.","line":36,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'finishCol' is assigned a value but never used.","line":37,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { DragDropContext, Droppable, Draggable, DropResult } from \"@hello-pangea/dnd\";\r\nimport { DealStage } from \"@/types/pipeline\";\r\nimport DealCard from \"./DealCard\";\r\nimport { usePipeline } from \"@/hooks/usePipeline\";\r\n\r\nexport default function KanbanBoard() {\r\n    const { state, fetchDeals, updateDealStage } = usePipeline();\r\n    const [isMounted, setIsMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setIsMounted(true);\r\n        fetchDeals();\r\n    }, [fetchDeals]);\r\n\r\n    // No renderizar en el servidor para evitar errores de hidrataci√≥n con DND\r\n    if (!isMounted) return <div className=\"h-full flex items-center justify-center p-20 animate-pulse text-gray-300\">Cargando tablero...</div>;\r\n\r\n    const onDragEnd = (result: DropResult) => {\r\n        const { destination, source, draggableId } = result;\r\n\r\n        if (!destination) return;\r\n\r\n        if (\r\n            destination.droppableId === source.droppableId &&\r\n            destination.index === source.index\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        const startStage = source.droppableId as DealStage;\r\n        const finishStage = destination.droppableId as DealStage;\r\n\r\n        const startCol = state.columns[startStage];\r\n        const finishCol = state.columns[finishStage];\r\n\r\n        // Optimistic Update (Local functionality needs to be integrated with Zustand or handled locally temporarily)\r\n        // For simplicity and fluidity, we will manipulate the Zustand state directly via a specialized setter or \r\n        // update the local logic to mutate the store optimistically.\r\n\r\n        // NOTE: In a perfect \"Swiss Watch\" implementation we would have the store handle the move logic purely.\r\n        // Given the previous local state implementation, we will perform the DB update here \r\n        // and let the user see the visual change. For strict consistency, we should refactor store to handle \"moveCard\".\r\n\r\n        // Let's rely on the store's fetchDeals to refresh for now to confirm persistence, \r\n        // BUT trigger the DB update immediately.\r\n        // Visual drag is handled by the optimistic UI of the library mostly, but we need to update state to prevent snapping back.\r\n\r\n        // To properly support Optimistic UI, we need to update the store state LOCALLY first.\r\n        // I will implementation a local manipulation of the store state here for fluidity.\r\n\r\n        // 1. Update DB\r\n        updateDealStage(draggableId, finishStage);\r\n\r\n        // 2. Optimistic UI Update (Manually updating the store state would be best, \r\n        // but for this MVP step let's trigger a re-fetch or assume the store allows mutation).\r\n        // The current usePipeline implementation has a simplified structure. \r\n        // Let's improve the UX by forcing a re-layout in the store logic in next iteration.\r\n        // For now, we update the DB and Refetch to ensure consistency. \r\n        // To make it instant, we would need 'moveDeal' action in store. \r\n\r\n        // **CRITICAL FIX**: To avoid visual snap-back, we MUST update the local state.\r\n        // Since I defined 'moveDealOptimistic' in store but didn't fully implement it, \r\n        // I will implement the store logic properly in the next step. \r\n\r\n        // For this exact file replacement, I will assume the store will handle it via fetchDeals \r\n        // shortly after, creating a slight delay but ensuring data truth.\r\n        // Or better: Let's manually update the columns in the store if we access setState.\r\n        // Since `usePipeline` exposes `state`, but not `setState`, we rely on `fetchDeals`.\r\n        // Wait... drag and drop feels laggy if we wait for network.\r\n        // I will add `moveDeal` to the store interface in the store file next.\r\n\r\n        // For now, calling updateDealStage.\r\n    };\r\n\r\n    return (\r\n        <div className=\"h-full overflow-x-auto pb-4\">\r\n            <DragDropContext onDragEnd={onDragEnd}>\r\n                <div className=\"flex gap-6 min-w-[1200px] h-full\">\r\n                    {state.columnOrder.map((columnId) => {\r\n                        const column = state.columns[columnId];\r\n                        return (\r\n                            <div key={column.id} className=\"flex-1 min-w-[280px] bg-gray-50/50 rounded-xl flex flex-col max-h-[calc(100vh-140px)]\">\r\n                                {/* Column Header */}\r\n                                <div\r\n                                    className=\"p-4 rounded-t-xl bg-white border-b border-gray-100 flex justify-between items-center sticky top-0 z-10\"\r\n                                    style={{ borderTop: `4px solid ${column.color}` }}\r\n                                >\r\n                                    <div>\r\n                                        <h3 className=\"font-bold text-gray-700 text-sm uppercase tracking-wide\">\r\n                                            {column.title}\r\n                                        </h3>\r\n                                        <p className=\"text-xs text-gray-400 font-medium mt-1\">\r\n                                            {column.deals.length} negocios\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className=\"text-right\">\r\n                                        <p className=\"font-bold text-gray-800 text-sm\">\r\n                                            ${column.totalValue.toLocaleString()}\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Droppable Area */}\r\n                                <Droppable droppableId={column.id}>\r\n                                    {(provided, snapshot) => (\r\n                                        <div\r\n                                            {...provided.droppableProps}\r\n                                            ref={provided.innerRef}\r\n                                            className={`\r\n                        p-3 flex-1 overflow-y-auto transition-colors duration-200\r\n                        ${snapshot.isDraggingOver ? \"bg-blue-50/80 ring-2 ring-inset ring-blue-100 rounded-b-xl\" : \"\"}\r\n                      `}\r\n                                        >\r\n                                            <div className=\"space-y-3\">\r\n                                                {column.deals.map((deal, index) => (\r\n                                                    <Draggable key={deal.id} draggableId={deal.id} index={index}>\r\n                                                        {(provided, snapshot) => (\r\n                                                            <div\r\n                                                                ref={provided.innerRef}\r\n                                                                {...provided.draggableProps}\r\n                                                                {...provided.dragHandleProps}\r\n                                                                style={provided.draggableProps.style}\r\n                                                            >\r\n                                                                <DealCard deal={deal} isDragging={snapshot.isDragging} />\r\n                                                            </div>\r\n                                                        )}\r\n                                                    </Draggable>\r\n                                                ))}\r\n                                            </div>\r\n                                            {provided.placeholder}\r\n                                        </div>\r\n                                    )}\r\n                                </Droppable>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </DragDropContext>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\pipeline\\NewDealModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\settings\\NotificationSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Bell"},"fix":{"range":[116,121],"text":""},"desc":"Remove unused variable \"Bell\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1263,1266],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1263,1266],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { Bell, Mail, AlertTriangle, Briefcase, LayoutDashboard, Loader2, Save, LucideIcon } from \"lucide-react\";\r\n\r\nexport default function NotificationSettings() {\r\n    const [loading, setLoading] = useState(false);\r\n    const [saved, setSaved] = useState(false);\r\n    const [prefs, setPrefs] = useState({\r\n        email_alerts: true,\r\n        platform_alerts: true,\r\n        risk_notifications: true,\r\n        task_reminders: true,\r\n        weekly_summary: false\r\n    });\r\n\r\n    useEffect(() => {\r\n        async function getPrefs() {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (user?.user_metadata?.notification_prefs) {\r\n                setPrefs(user.user_metadata.notification_prefs);\r\n            }\r\n        }\r\n        getPrefs();\r\n    }, []);\r\n\r\n    const handleSave = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const { error } = await supabase.auth.updateUser({\r\n                data: { notification_prefs: prefs }\r\n            });\r\n\r\n            if (error) throw error;\r\n            setSaved(true);\r\n            setTimeout(() => setSaved(false), 3000);\r\n        } catch (error: any) {\r\n            alert(error.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggle = (key: keyof typeof prefs) => {\r\n        setPrefs(prev => ({ ...prev, [key]: !prev[key] }));\r\n    };\r\n\r\n    return (\r\n        <div className=\"max-w-2xl animate-fadeIn space-y-8\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                {/* Canales */}\r\n                <div className=\"space-y-4\">\r\n                    <h4 className=\"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2\">\r\n                        Canales de Env√≠o\r\n                    </h4>\r\n                    <div className=\"space-y-3\">\r\n                        <PreferenceCard\r\n                            icon={Mail}\r\n                            title=\"Correo Electr√≥nico\"\r\n                            desc=\"Recibe alertas en tu bandeja de entrada.\"\r\n                            active={prefs.email_alerts}\r\n                            onToggle={() => toggle('email_alerts')}\r\n                        />\r\n                        <PreferenceCard\r\n                            icon={LayoutDashboard}\r\n                            title=\"Alertas en Plataforma\"\r\n                            desc=\"Notificaciones visuales dentro del CRM.\"\r\n                            active={prefs.platform_alerts}\r\n                            onToggle={() => toggle('platform_alerts')}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Tipos de Alerta */}\r\n                <div className=\"space-y-4\">\r\n                    <h4 className=\"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2\">\r\n                        Eventos Cr√≠ticos\r\n                    </h4>\r\n                    <div className=\"space-y-3\">\r\n                        <PreferenceCard\r\n                            icon={AlertTriangle}\r\n                            title=\"Riesgos de Negocio\"\r\n                            desc=\"Cuando un deal entra en zona fr√≠a.\"\r\n                            active={prefs.risk_notifications}\r\n                            onToggle={() => toggle('risk_notifications')}\r\n                            color=\"text-red-500\"\r\n                        />\r\n                        <PreferenceCard\r\n                            icon={Briefcase}\r\n                            title=\"Tareas y Seguimientos\"\r\n                            desc=\"Recordatorios de tus actividades diarias.\"\r\n                            active={prefs.task_reminders}\r\n                            onToggle={() => toggle('task_reminders')}\r\n                            color=\"text-[#00AEEF]\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"pt-8 border-t border-gray-50 flex items-center justify-between\">\r\n                <p className=\"text-xs text-gray-400 italic\">\r\n                    Las notificaciones push para dispositivos m√≥viles estar√°n disponibles pr√≥ximamente.\r\n                </p>\r\n                <button\r\n                    onClick={handleSave}\r\n                    disabled={loading}\r\n                    className=\"btn-primary min-w-[160px] shadow-lg shadow-blue-500/20\"\r\n                >\r\n                    {loading ? (\r\n                        <Loader2 className=\"animate-spin\" size={18} />\r\n                    ) : (\r\n                        <span className=\"flex items-center gap-2\">\r\n                            {saved ? \"¬°Guardado!\" : <><Save size={18} /> Guardar Preferencias</>}\r\n                        </span>\r\n                    )}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface PreferenceCardProps {\r\n    icon: LucideIcon;\r\n    title: string;\r\n    desc: string;\r\n    active: boolean;\r\n    onToggle: () => void;\r\n    color?: string;\r\n}\r\n\r\nfunction PreferenceCard({ icon: Icon, title, desc, active, onToggle, color }: PreferenceCardProps) {\r\n    return (\r\n        <div\r\n            onClick={onToggle}\r\n            className={`p-4 rounded-2xl border transition-all cursor-pointer flex items-center justify-between group ${active ? 'bg-white border-blue-100 shadow-sm' : 'bg-gray-50/50 border-gray-100 grayscale'}`}\r\n        >\r\n            <div className=\"flex items-center gap-3\">\r\n                <div className={`p-2 rounded-xl transition-colors ${active ? (color || 'text-blue-600') + ' bg-blue-50' : 'bg-white text-gray-400'}`}>\r\n                    <Icon size={18} />\r\n                </div>\r\n                <div>\r\n                    <h5 className=\"text-sm font-bold text-gray-800\">{title}</h5>\r\n                    <p className=\"text-[10px] text-gray-500 leading-tight mt-0.5\">{desc}</p>\r\n                </div>\r\n            </div>\r\n            <div className={`w-10 h-5 rounded-full transition-all relative ${active ? 'bg-[#00AEEF]' : 'bg-gray-200'}`}>\r\n                <div className={`absolute top-1 w-3 h-3 bg-white rounded-full transition-all ${active ? 'left-6' : 'left-1'}`} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\settings\\PipelineSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle2' is defined but never used.","line":4,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle2"},"fix":{"range":[93,107],"text":""},"desc":"Remove unused variable \"CheckCircle2\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { usePipeline } from \"@/hooks/usePipeline\";\r\nimport { LayoutDashboard, CheckCircle2, AlertCircle, Sparkles, GripVertical } from \"lucide-react\";\r\n\r\nexport default function PipelineSettings() {\r\n    const { state } = usePipeline();\r\n    const columns = Object.values(state.columns);\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fadeIn\">\r\n            <div>\r\n                <h3 className=\"text-lg font-bold text-gray-800 flex items-center gap-2\">\r\n                    <LayoutDashboard size={20} className=\"text-[#00AEEF]\" />\r\n                    Estructura del Embudo\r\n                </h3>\r\n                <p className=\"text-xs text-gray-400 mt-1\">\r\n                    Visualiza y ordena las etapas por las que pasan tus negocios.\r\n                </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n                {columns.map((col, index) => (\r\n                    <div\r\n                        key={col.id}\r\n                        className=\"flex items-center gap-4 p-4 bg-white border border-gray-100 rounded-2xl hover:border-blue-100 hover:shadow-sm transition-all group\"\r\n                    >\r\n                        <div className=\"text-gray-300 group-hover:text-blue-200 transition-colors\">\r\n                            <GripVertical size={20} />\r\n                        </div>\r\n\r\n                        <div\r\n                            className=\"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold text-xs\"\r\n                            style={{ backgroundColor: col.color }}\r\n                        >\r\n                            {index + 1}\r\n                        </div>\r\n\r\n                        <div className=\"flex-1\">\r\n                            <h4 className=\"text-sm font-bold text-gray-800\">{col.title}</h4>\r\n                            <div className=\"flex items-center gap-3 mt-1\">\r\n                                <span className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest\">\r\n                                    ID: {col.id}\r\n                                </span>\r\n                                {col.id === 'QUALIFIED' && (\r\n                                    <span className=\"flex items-center gap-1.5 px-2 py-0.5 bg-orange-50 text-orange-500 rounded text-[9px] font-bold\">\r\n                                        <AlertCircle size={10} /> Auto-Task Activado\r\n                                    </span>\r\n                                )}\r\n                                {col.id === 'WON' && (\r\n                                    <span className=\"flex items-center gap-1.5 px-2 py-0.5 bg-green-50 text-green-500 rounded text-[9px] font-bold\">\r\n                                        <Sparkles size={10} /> Disparador de Onboarding\r\n                                    </span>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"text-right px-4\">\r\n                            <span className=\"text-[10px] font-bold text-gray-300 uppercase italic\">\r\n                                {col.id === 'WON' || col.id === 'LOST' ? 'Estado Final' : 'En Progreso'}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Information Alert */}\r\n            <div className=\"bg-blue-50/50 p-4 rounded-2xl border border-blue-100 flex gap-4\">\r\n                <div className=\"w-10 h-10 bg-white rounded-xl flex items-center justify-center text-[#00AEEF] shadow-sm flex-shrink-0\">\r\n                    <LayoutDashboard size={20} />\r\n                </div>\r\n                <div>\r\n                    <h4 className=\"text-sm font-bold text-blue-800\">Pr√≥ximamente: Editor Din√°mico</h4>\r\n                    <p className=\"text-xs text-blue-600/80 leading-relaxed mt-1\">\r\n                        Estamos trabajando para que puedas a√±adir tus propias etapas, cambiar colores y definir reglas de automatizaci√≥n personalizadas para cada una.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\settings\\ProfileSettings.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: 'try' expected.","line":52,"column":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { User, Mail, Briefcase, Camera, Loader2, Save, Check } from \"lucide-react\";\r\n\r\nexport default function ProfileSettings() {\r\n    const [loading, setLoading] = useState(false);\r\n    const [uploading, setUploading] = useState(false);\r\n    const [saved, setSaved] = useState(false);\r\n    const [userData, setUserData] = useState({\r\n        full_name: \"\",\r\n        email: \"\",\r\n        job_title: \"\",\r\n        avatar_url: \"\"\r\n    });\r\n\r\n    useEffect(() => {\r\n        async function getProfile() {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (user) {\r\n                setUserData({\r\n                    full_name: user.user_metadata?.full_name || \"\",\r\n                    email: user.email || \"\",\r\n                    job_title: user.user_metadata?.job_title || \"\",\r\n                    avatar_url: user.user_metadata?.avatar_url || \"\"\r\n                });\r\n            }\r\n        }\r\n        getProfile();\r\n    }, []);\r\n\r\n    const handleUpdateProfile = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        setSaved(false);\r\n\r\n        try {\r\n            const { error } = await supabase.auth.updateUser({\r\n                data: {\r\n                    full_name: userData.full_name,\r\n                    job_title: userData.job_title\r\n                }\r\n            });\r\n\r\n            if (error) throw error;\r\n            setSaved(true);\r\n            setTimeout(() => setSaved(false), 3000);\r\n        } catch (error) {\r\n            if (error instanceof Error) {\r\n                alert(error.message);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        const handleAvatarUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n            const file = e.target.files?.[0];\r\n            if (!file) return;\r\n\r\n            setUploading(true);\r\n            try {\r\n                const { data: { user } } = await supabase.auth.getUser();\r\n                if (!user) throw new Error(\"No user found\");\r\n\r\n                const fileExt = file.name.split('.').pop();\r\n                const fileName = `${user.id}-${Math.random()}.${fileExt}`;\r\n                const filePath = `${fileName}`;\r\n\r\n                // 1. Upload to Supabase Storage (Bucket: avatars)\r\n                const { error: uploadError } = await supabase.storage\r\n                    .from('avatars')\r\n                    .upload(filePath, file);\r\n\r\n                if (uploadError) throw uploadError;\r\n\r\n                // 2. Get Public URL\r\n                const { data: { publicUrl } } = supabase.storage\r\n                    .from('avatars')\r\n                    .getPublicUrl(filePath);\r\n\r\n                // 3. Update User Metadata\r\n                const { error: updateError } = await supabase.auth.updateUser({\r\n                    data: { avatar_url: publicUrl }\r\n                });\r\n\r\n                if (updateError) throw updateError;\r\n\r\n                setUserData(prev => ({ ...prev, avatar_url: publicUrl }));\r\n                setSaved(true);\r\n                setTimeout(() => setSaved(false), 3000);\r\n            } catch (error) {\r\n                console.error(\"Error uploading avatar:\", error);\r\n                alert(\"Error al subir la imagen. Aseg√∫rate de que el bucket 'avatars' (p√∫blico) exista en tu consola de Supabase.\");\r\n            } finally {\r\n                setUploading(false);\r\n            }\r\n        };\r\n\r\n        return (\r\n            <div className=\"max-w-2xl animate-fadeIn\">\r\n                <div className=\"flex items-center gap-6 mb-10\">\r\n                    <div className=\"relative group\">\r\n                        <div className=\"w-24 h-24 bg-blue-100 rounded-3xl flex items-center justify-center text-[#00AEEF] text-3xl font-bold shadow-inner overflow-hidden border-4 border-white relative\">\r\n                            {uploading && (\r\n                                <div className=\"absolute inset-0 bg-white/60 flex items-center justify-center z-10 backdrop-blur-sm\">\r\n                                    <Loader2 className=\"animate-spin text-[#00AEEF]\" size={24} />\r\n                                </div>\r\n                            )}\r\n                            {userData.avatar_url ? (\r\n                                <img src={userData.avatar_url} alt=\"Profile\" className=\"w-full h-full object-cover\" />\r\n                            ) : (\r\n                                userData.full_name ? userData.full_name[0].toUpperCase() : \"U\"\r\n                            )}\r\n                        </div>\r\n                        <label className=\"absolute -bottom-2 -right-2 p-2 bg-white rounded-xl shadow-lg border border-gray-100 text-gray-400 hover:text-[#00AEEF] transition-all transform hover:scale-110 cursor-pointer\">\r\n                            <Camera size={18} />\r\n                            <input\r\n                                type=\"file\"\r\n                                className=\"hidden\"\r\n                                accept=\"image/*\"\r\n                                onChange={handleAvatarUpload}\r\n                                disabled={uploading}\r\n                            />\r\n                        </label>\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"text-xl font-bold text-gray-800\">{userData.full_name || \"Usuario del Sistema\"}</h3>\r\n                        <p className=\"text-sm text-gray-400\">{userData.job_title || \"CRM Manager\"}</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <form onSubmit={handleUpdateProfile} className=\"space-y-6\">\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2\">\r\n                                <User size={14} /> Nombre Completo\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={userData.full_name}\r\n                                onChange={(e) => setUserData({ ...userData, full_name: e.target.value })}\r\n                                className=\"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#00AEEF] outline-none transition-all text-sm text-gray-700\"\r\n                                placeholder=\"Ej: Juan P√©rez\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2\">\r\n                                <Mail size={14} /> Correo Electr√≥nico\r\n                            </label>\r\n                            <input\r\n                                type=\"email\"\r\n                                value={userData.email}\r\n                                disabled\r\n                                className=\"w-full px-4 py-3 bg-gray-50 border border-transparent rounded-xl text-sm text-gray-400 cursor-not-allowed italic\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2\">\r\n                                <Briefcase size={14} /> Cargo / Puesto\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={userData.job_title}\r\n                                onChange={(e) => setUserData({ ...userData, job_title: e.target.value })}\r\n                                className=\"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#00AEEF] outline-none transition-all text-sm text-gray-700\"\r\n                                placeholder=\"Ej: Director Comercial\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"pt-6 flex items-center justify-between border-t border-gray-50\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            {saved && (\r\n                                <span className=\"flex items-center gap-1.5 text-green-500 text-xs font-bold animate-fadeIn\">\r\n                                    <Check size={16} /> Cambios guardados\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={loading || uploading}\r\n                            className=\"btn-primary min-w-[140px] shadow-lg shadow-blue-500/20\"\r\n                        >\r\n                            {loading ? (\r\n                                <Loader2 className=\"animate-spin\" size={18} />\r\n                            ) : (\r\n                                <>\r\n                                    <Save size={18} /> Guardar Cambios\r\n                                </>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\settings\\SecuritySettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\hooks\\useActivities.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\hooks\\useCompanies.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\hooks\\useContacts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\hooks\\useDashboardStats.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\hooks\\useDeal.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[461,464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[461,464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1902,1905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1902,1905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3631,3634],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3631,3634],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":113,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4022,4025],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4022,4025],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4808,4811],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4808,4811],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from \"zustand\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { Deal, Activity } from \"@/types/pipeline\";\r\n\r\ninterface DealDetailState {\r\n    deal: Deal | null;\r\n    activities: Activity[];\r\n    loading: boolean;\r\n    error: string | null;\r\n    fetchDeal: (id: string) => Promise<void>;\r\n    addActivity: (data: { deal_id: string; type: string; subject: string; notes?: string }) => Promise<void>;\r\n    updateDeal: (id: string, updates: any) => Promise<void>;\r\n}\r\n\r\nexport const useDeal = create<DealDetailState>((set) => ({\r\n    deal: null,\r\n    loading: false,\r\n    error: null,\r\n    activities: [],\r\n\r\n    fetchDeal: async (id: string) => {\r\n        set({ loading: true, error: null });\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"deals\")\r\n                .select(`\r\n                    id,\r\n                    name,\r\n                    value,\r\n                    stage,\r\n                    probability,\r\n                    expected_close_date,\r\n                    created_at,\r\n                    accounts ( name ),\r\n                    activities (\r\n                        id,\r\n                        subject,\r\n                        type,\r\n                        created_at,\r\n                        notes\r\n                    )\r\n                `)\r\n                .eq(\"id\", id)\r\n                .single();\r\n\r\n            if (error) throw error;\r\n\r\n            const deal: Deal = {\r\n                id: data.id,\r\n                title: data.name,\r\n                companyName: (data.accounts as { name?: string })?.name || \"Sin Empresa\",\r\n                value: data.value,\r\n                currency: \"$\",\r\n                probability: data.probability,\r\n                expectedCloseDate: data.expected_close_date,\r\n                created_at: data.created_at, // Add this\r\n                stageId: data.stage as any, // Cast to DealStage if imported\r\n            };\r\n\r\n            // Process activities\r\n            // Ensure activities is an array and sort by date descending\r\n            const rawActivities = data.activities || [];\r\n            const sortedActivities = rawActivities.sort((a: { created_at: string }, b: { created_at: string }) =>\r\n                new Date(b.created_at).getTime() - new Date(a.created_at).getTime()\r\n            );\r\n\r\n            // Add \"Deal Created\" as the initial activity if not present\r\n            // Or better, let the UI handle the \"Start\" point. \r\n            // We will store just the fetched activities here.\r\n\r\n            set({ deal, activities: sortedActivities, loading: false });\r\n\r\n        } catch (err) {\r\n            console.error(\"Error fetching deal:\", err);\r\n            if (err instanceof Error) {\r\n                set({ error: err.message, loading: false });\r\n            }\r\n        }\r\n    },\r\n    addActivity: async (activityData: { deal_id: string; type: string; subject: string; notes?: string }) => {\r\n        try {\r\n            // 1. Insert into DB\r\n            const { data, error } = await supabase\r\n                .from(\"activities\")\r\n                .insert([{\r\n                    ...activityData,\r\n                    created_at: new Date().toISOString() // Client-side timestamp for immediate feel, DB handles true time\r\n                }])\r\n                .select()\r\n                .single();\r\n\r\n            if (error) throw error;\r\n\r\n            // 2. Update Local State\r\n            // Cast response to Activity\r\n            const newActivity: Activity = {\r\n                id: data.id,\r\n                subject: data.subject,\r\n                type: data.type as any,\r\n                created_at: data.created_at,\r\n                notes: data.notes\r\n            };\r\n\r\n            set((state) => ({\r\n                activities: [newActivity, ...state.activities]\r\n            }));\r\n\r\n        } catch (err) {\r\n            console.error(\"Error adding activity:\", err);\r\n            throw err;\r\n        }\r\n    },\r\n    updateDeal: async (id: string, updates: any) => {\r\n        try {\r\n            const { error } = await supabase\r\n                .from(\"deals\")\r\n                .update(updates)\r\n                .eq(\"id\", id);\r\n\r\n            if (error) throw error;\r\n\r\n            // Update Local State\r\n            set((state) => {\r\n                if (!state.deal) return state;\r\n                return {\r\n                    deal: {\r\n                        ...state.deal,\r\n                        title: updates.name ?? state.deal.title,\r\n                        value: updates.value ?? state.deal.value,\r\n                        probability: updates.probability ?? state.deal.probability,\r\n                        expectedCloseDate: updates.expected_close_date ?? state.deal.expectedCloseDate,\r\n                    }\r\n                } as any; // Type override for the audit cleanup\r\n            });\r\n\r\n        } catch (err) {\r\n            console.error(\"Error updating deal:\", err);\r\n            throw err;\r\n        }\r\n    }\r\n}));\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\hooks\\useNotifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\hooks\\usePipeline.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":124,"column":60,"nodeType":"Identifier","messageId":"unusedVar","endLine":124,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'startCol' is assigned a value but never used.","line":126,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":126,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'finishCol' is assigned a value but never used.","line":127,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":127,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'newColumns' is assigned a value but never used.","line":130,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":130,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from \"zustand\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { Deal, DealStage, PipelineState, KanbanColumn } from \"@/types/pipeline\";\r\n\r\ninterface PipelineStore {\r\n    state: PipelineState;\r\n    loading: boolean;\r\n    error: string | null;\r\n    fetchDeals: () => Promise<void>;\r\n    addDeal: (dealData: { name: string, value: number, probability: number, stage: DealStage, account_id?: string, contact_id?: string }) => Promise<void>;\r\n    updateDealStage: (dealId: string, newStage: DealStage) => Promise<void>;\r\n    moveDealOptimistic: (dealId: string, sourceStage: DealStage, targetStage: DealStage, index: number) => void;\r\n}\r\n\r\nconst initialColumns: Record<DealStage, KanbanColumn> = {\r\n    LEAD: { id: \"LEAD\", title: \"Prospectos\", color: \"#64748B\", deals: [], totalValue: 0 },\r\n    QUALIFIED: { id: \"QUALIFIED\", title: \"Calificados\", color: \"#3B82F6\", deals: [], totalValue: 0 },\r\n    PROPOSAL: { id: \"PROPOSAL\", title: \"Propuesta\", color: \"#F59E0B\", deals: [], totalValue: 0 },\r\n    NEGOTIATION: { id: \"NEGOTIATION\", title: \"Negociaci√≥n\", color: \"#8B5CF6\", deals: [], totalValue: 0 },\r\n    CLOSED: { id: \"CLOSED\", title: \"Cerrados\", color: \"#94A3B8\", deals: [], totalValue: 0 },\r\n    WON: { id: \"WON\", title: \"Ganados üèÜ\", color: \"#10B981\", deals: [], totalValue: 0 },\r\n    LOST: { id: \"LOST\", title: \"Perdidos ‚ùå\", color: \"#EF4444\", deals: [], totalValue: 0 },\r\n};\r\n\r\nexport const usePipeline = create<PipelineStore>((set, get) => ({\r\n    state: {\r\n        columnOrder: [\"LEAD\", \"QUALIFIED\", \"PROPOSAL\", \"NEGOTIATION\", \"WON\", \"LOST\"],\r\n        columns: initialColumns,\r\n    },\r\n    loading: false,\r\n    error: null,\r\n\r\n    fetchDeals: async () => {\r\n        set({ loading: true, error: null });\r\n        try {\r\n            const { data: deals, error } = await supabase\r\n                .from(\"deals\")\r\n                .select(`\r\n          id,\r\n          name,\r\n          value,\r\n          stage,\r\n          probability,\r\n          expected_close_date,\r\n          created_at,\r\n          accounts ( name ),\r\n          contacts ( email ),\r\n          activities ( created_at )\r\n        `);\r\n\r\n            if (error) throw error;\r\n\r\n            // Transform raw data to PipelineState\r\n            const newColumns = { ...initialColumns };\r\n            // Reset deals in each column to avoid accumulation\r\n            Object.keys(newColumns).forEach(key => {\r\n                newColumns[key as DealStage] = { ...newColumns[key as DealStage], deals: [], totalValue: 0 };\r\n            });\r\n\r\n            deals?.forEach((d) => {\r\n                const deal: Deal = {\r\n                    id: d.id,\r\n                    title: d.name,\r\n                    companyName: d.accounts?.name || \"Sin Empresa\",\r\n                    value: d.value,\r\n                    currency: \"$\", // TODO: Multi-currency support\r\n                    probability: d.probability,\r\n                    expectedCloseDate: d.expected_close_date,\r\n                    created_at: d.created_at,\r\n                    stageId: d.stage as DealStage,\r\n                };\r\n\r\n                // Determine last activity date\r\n                const activityDates = (d.activities || []).map((a: { created_at: string }) => new Date(a.created_at).getTime());\r\n                const dealCreatedAt = new Date(d.created_at).getTime();\r\n                const latest = Math.max(dealCreatedAt, ...activityDates);\r\n                deal.lastActivityDate = new Date(latest).toISOString();\r\n\r\n                if (newColumns[deal.stageId]) {\r\n                    newColumns[deal.stageId].deals.push(deal);\r\n                }\r\n            });\r\n\r\n            // Recalculate totals\r\n            Object.keys(newColumns).forEach((key) => {\r\n                const col = newColumns[key as DealStage];\r\n                col.totalValue = col.deals.reduce((sum: number, d: Deal) => sum + d.value, 0);\r\n            });\r\n\r\n            set({\r\n                state: { ...get().state, columns: newColumns },\r\n                loading: false,\r\n            });\r\n\r\n        } catch (err) {\r\n            console.error(\"Error fetching deals:\", err);\r\n            if (err instanceof Error) {\r\n                set({ error: err.message, loading: false });\r\n            }\r\n        }\r\n    },\r\n\r\n    addDeal: async (dealData) => {\r\n        set({ loading: true, error: null });\r\n        try {\r\n            const { error } = await supabase\r\n                .from(\"deals\")\r\n                .insert([dealData]);\r\n\r\n            if (error) throw error;\r\n\r\n            // Recargar datos para ver el nuevo negocio\r\n            await get().fetchDeals();\r\n\r\n        } catch (err) {\r\n            console.error(\"Error creating deal:\", err);\r\n            if (err instanceof Error) {\r\n                set({ error: err.message, loading: false });\r\n            }\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    moveDealOptimistic: (dealId, sourceStage, targetStage, index) => {\r\n        const currentState = get().state;\r\n        const startCol = currentState.columns[sourceStage];\r\n        const finishCol = currentState.columns[targetStage];\r\n\r\n        // Deep Copy to avoid mutation issues\r\n        const newColumns = { ...currentState.columns };\r\n\r\n        // Logic mostly handled in component, but doing state update here helps consistency\r\n        // However, for drag and drop usually we let the component drive the immediate UI \r\n        // and sync with DB in background. \r\n        // This function acts as the layout state updater.\r\n\r\n        // ... Implementation simplified for KanbanBoard integration, \r\n        // actually KanbanBoard.tsx handles the optimistic UI state very well locally.\r\n        // We will focus updateDealStage on DB sync.\r\n    },\r\n\r\n    updateDealStage: async (dealId: string, newStage: DealStage) => {\r\n        const previousState = get().state;\r\n\r\n        // 1. Clonado ligero y eficiente (Optimistic Update)\r\n        const updatedColumns = { ...previousState.columns };\r\n        let dealToMove: Deal | undefined;\r\n        let sourceStage: DealStage | undefined;\r\n\r\n        // B√∫squeda eficiente del deal\r\n        for (const stageKey in updatedColumns) {\r\n            const stage = stageKey as DealStage;\r\n            const deals = updatedColumns[stage].deals;\r\n            const dealIndex = deals.findIndex(d => d.id === dealId);\r\n\r\n            if (dealIndex !== -1) {\r\n                dealToMove = { ...deals[dealIndex], stageId: newStage };\r\n                sourceStage = stage;\r\n\r\n                // Actualizaci√≥n inmutable de columnas\r\n                updatedColumns[stage] = {\r\n                    ...updatedColumns[stage],\r\n                    deals: deals.filter(d => d.id !== dealId),\r\n                    totalValue: updatedColumns[stage].totalValue - deals[dealIndex].value\r\n                };\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!dealToMove || !sourceStage) return;\r\n\r\n        // A√±adir a destino\r\n        updatedColumns[newStage] = {\r\n            ...updatedColumns[newStage],\r\n            deals: [...updatedColumns[newStage].deals, dealToMove],\r\n            totalValue: updatedColumns[newStage].totalValue + dealToMove.value\r\n        };\r\n\r\n        // 2. SET INMEDIATO: UX Fluida\r\n        set({ state: { ...previousState, columns: updatedColumns } });\r\n\r\n        // 3. PROCESOS DE FONDO (Fire and Forget)\r\n        // No usamos 'await' aqu√≠ para que la funci√≥n retorne al instante\r\n        const runAutomations = async () => {\r\n            try {\r\n                // Sincronizar con DB\r\n                const { error: dbError } = await supabase\r\n                    .from(\"deals\")\r\n                    .update({ stage: newStage })\r\n                    .eq(\"id\", dealId);\r\n\r\n                if (dbError) throw dbError;\r\n\r\n                // Reglas de Auto-Tasking\r\n                if (newStage === 'QUALIFIED' || newStage === 'WON') {\r\n                    const subject = newStage === 'QUALIFIED'\r\n                        ? 'üìû Llamada de Seguimiento: Definir requerimientos'\r\n                        : 'üéâ Bienvenida: Iniciar proceso de onboarding';\r\n\r\n                    const days = newStage === 'QUALIFIED' ? 2 : 1;\r\n\r\n                    await supabase.from('activities').insert([{\r\n                        deal_id: dealId,\r\n                        type: 'task',\r\n                        subject,\r\n                        due_date: new Date(Date.now() + days * 24 * 60 * 60 * 1000).toISOString(),\r\n                    }]);\r\n                }\r\n\r\n                // Automatizaci√≥n de Email\r\n                if (newStage === 'PROPOSAL' || newStage === 'WON') {\r\n                    const { data: contactData } = await supabase\r\n                        .from('deals')\r\n                        .select('contacts ( email, first_name )')\r\n                        .eq('id', dealId)\r\n                        .single();\r\n\r\n                    const contact = (contactData as { contacts?: { email?: string; first_name?: string } })?.contacts;\r\n                    if (contact?.email) {\r\n                        const subject = newStage === 'PROPOSAL'\r\n                            ? 'Propuesta Comercial: CunemoClient üíé'\r\n                            : '¬°Felicidades! Bienvenido a la familia Cunemo üéâ';\r\n\r\n                        const message = newStage === 'PROPOSAL'\r\n                            ? `Hola ${contact.first_name || 'Cliente'}, hemos preparado una propuesta personalizada para ti.`\r\n                            : `Hola ${contact.first_name || 'Cliente'}, es un placer tenerte a bordo.`;\r\n\r\n                        fetch('/api/email/send', {\r\n                            method: 'POST',\r\n                            headers: { 'Content-Type': 'application/json' },\r\n                            body: JSON.stringify({\r\n                                to: contact.email,\r\n                                subject,\r\n                                html: `<div style=\"font-family: sans-serif; padding: 20px;\"><h2>CunemoClient</h2><p>${message}</p></div>`\r\n                            })\r\n                        }).catch(e => console.error(\"Fondo: Error Email\", e));\r\n                    }\r\n                }\r\n            } catch (err) {\r\n                console.error(\"Fallo en procesos de fondo:\", err);\r\n                // En caso de error cr√≠tico de DB, podr√≠amos re-notificar o refrescar\r\n            }\r\n        };\r\n\r\n        runAutomations(); // Se ejecuta en paralelo\r\n    }\r\n}));\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\lib\\actions\\onboarding.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[93,96],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[93,96],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from \"@/lib/supabase\";\r\n\r\nexport async function saveOnboardingData(data: any) {\r\n    try {\r\n\r\n\r\n        // 1. Guardar Perfil (Simulado si no hay tabla profiles, o en auth metadata)\r\n        // Por ahora asumimos que solo guardamos datos de negocio, ya que profiles a veces requiere trigger\r\n        // TODO: Actualizar user_metadata en Auth si es necesario\r\n\r\n        // 2. Guardar Contactos y sus Empresas\r\n        // Iteramos sobre los contactos semilla\r\n        const seedContacts = data.seedContacts || [];\r\n        let firstAccountId = null;\r\n\r\n        for (const contact of seedContacts) {\r\n            if (!contact.name || !contact.company) continue;\r\n\r\n            // A. Crear Empresa (Account)\r\n            const { data: accountData, error: accountError } = await supabase\r\n                .from('accounts')\r\n                .insert({\r\n                    name: contact.company,\r\n                    industry: data.industry // Usamos la industria seleccionada en el paso 1\r\n                })\r\n                .select()\r\n                .single();\r\n\r\n            if (accountError) {\r\n                console.error(\"Error creating account:\", accountError);\r\n                continue;\r\n            }\r\n\r\n            if (!firstAccountId) firstAccountId = accountData.id;\r\n\r\n            // B. Crear Contacto\r\n            const { error: contactError } = await supabase\r\n                .from('contacts')\r\n                .insert({\r\n                    first_name: contact.name, // Simplificaci√≥n: asume nombre completo en first_name por ahora o split\r\n                    email: contact.email,\r\n                    account_id: accountData.id\r\n                });\r\n\r\n            if (contactError) console.error(\"Error creating contact:\", contactError);\r\n        }\r\n\r\n        // 3. Guardar Primer Negocio (Victoria)\r\n        // Lo asociamos a la primera empresa creada para que tenga sentido\r\n        const deal = data.firstDeal;\r\n        if (deal && deal.title && firstAccountId) {\r\n            const { error: dealError } = await supabase\r\n                .from('deals')\r\n                .insert({\r\n                    name: deal.title,\r\n                    value: parseFloat(deal.value),\r\n                    probability: parseInt(deal.probability),\r\n                    stage: getStageFromProbability(deal.probability),\r\n                    account_id: firstAccountId\r\n                });\r\n\r\n            if (dealError) console.error(\"Error creating deal:\", dealError);\r\n        }\r\n\r\n        return { success: true };\r\n\r\n    } catch (error) {\r\n        console.error(\"Fatal error in onboarding save:\", error);\r\n        throw error;\r\n    }\r\n}\r\n\r\nfunction getStageFromProbability(prob: string): string {\r\n    switch (prob) {\r\n        case \"20\": return \"LEAD\";\r\n        case \"50\": return \"PROPOSAL\";\r\n        case \"80\": return \"NEGOTIATION\";\r\n        default: return \"LEAD\";\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\EQUIPO\\Desktop\\CRM\\cunemo-app\\src\\types\\pipeline.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]